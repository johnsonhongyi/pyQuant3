top_all.query(' low < (ma51d*7+ma201d*3)/8.9 and  low > (ma51d*7+ma201d*3)/10 ')
top_all.query(' low < (ma51d*7+ma201d*3)/8.9 and  low > (ma51d*7+ma201d*3)/9 ')
top_all.query('lastl1d > ma51d and lastl2d >ma52d and percent > 0')
top_temp.query('lastp1d > lastp2d >lastp3d')
top_temp.query('lastp1d > lastp2d >lastp3d >lastp4d')
top_temp.query('lastp1d > lastp2d >lastp3d >lastp4d') 
top_temp.query('lastp1d > lastp2d >lastp3d >lastp4d').per2d[:10]
top_temp.query('lastp1d > lastp2d >lastp3d >lastp4d')[-10:]
top_all.query('lastl1d > ma51d and lastl2d >ma52d and percent > 0') 
top_temp.query('lastp1d > lastp2d >lastp3d >lastp4d and percent >0')
top_all.query('lastp1d > lastp2d >lastp3d >lastp4d')
top_all.query('lastp1d > lastp2d >lastp3d >lastp4d') 
top_temp.query('high > max5 and lasth1d >ma51d and lasth2d > ma52d and lasth3d > ma53d')
top_temp.query('high > max5 and lasth1d >ma51d and lasth2d > ma52d and lasth3d > ma53d and lastv1d > lastv2d*2')
top_all.query('high > max5 and lasth1d >ma51d and lasth2d > ma52d and lasth3d > ma53d and lastv1d > lastv2d*2')
top_all.query('high > max5 and lasth1d >ma51d and (per1d > 5 or per2d > 5)')
top_all.query('high > max5 and lasth1d >ma51d and (per1d > 5 or per2d > 5 or per3d > 8 or per4d >8 or per5d > 8)')
top_all.query('high > max5 and lasth1d >ma51d and (per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 or per5d > 8)')
top_all.query('high > max5 and lasth1d >ma51d and (per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 or per5d > 8 or per6d >8)')
top_all.query('high > max5 and lasth1d >ma51d and (per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 or per5d > 8 or per6d >8 and percent >0)')
top_all.query('high > max5 and lasth1d >ma51d and (per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 or per5d > 8 or per6d >8 ) and percent >0')
top_all.query('high > max5 and lasth1d >ma51d and (per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 and ( per5d > 8 or per6d >8) ) and percent >0')
top_all.query('high > max5 and lasth1d >ma51d and per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 and percent >0')
top_temp.query('high > max5 and lasth1d >ma51d and per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 and percent >0')
top_temp.query('high > max5 and lasth1d >ma51d and per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 ')
top_temp.query('high > max5 and lasth1d >ma51d and per1d > 0 and  per2d > 0 and per3d > 0 and per4d >0 ').loc[:,['lastp','close']] top_all.query('high > max5 and lastp2d < upper')
top_all.query('high > max5 and lasth2d < upper')
top_all.query('high > max5 and lasth2d < upper and high > upper')
top_all.query('high > max5 and lasth2d < upper and high > upper and max5==high4')
top_temp.query('high > max5 and lasth2d < upper and high > upper and max5==high4')
top_temp.query('high > max5 and lasth2d < upper and high > upper and max5==high4').topU
top_temp.query('close > ma201d')
top_temp.query('close > ma201d')[:20]
top_temp.query('close > ma201d and close < ma201d*1.1')
top_temp.query('close > ma201d and close < ma201d*1.1 and close > df2')
top_temp.query('close > ma201d and close < ma201d*1.1 and close > df2 and low >df2')
top_temp.query('close > ma201d and close < ma201d*1.1 and close > df2 and low >df2 and low < ma201d*1.1')
top_temp.query('close > ma201d and close < ma201d*1.1 and close > df2 and low >df2 and low < ma51d*1.1')
top_temp.query('close > ma201d and close < ma201d*1.1 and close > df2 and low >df2 and low < df2*1.1')
top_temp.query('macddif > 0')
top_temp.query('macddea > 0')
top_all.query('macddea > 0')
top_all.query('macd > 0')
top_temp.query('macd >0 and macddif > macddea')
top_temp.query('macd >0 and macddif > macddea and macdlast2 > macdlast3')
top_temp.query('macd >0 and macddif > macddea and macdlast2 > macdlast3 and low < df2')
top_temp.query('macd >-1 and macddif > macddea and macdlast2 > macdlast3 and low < df2')
top_temp.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3 and low < df2')
top_temp.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3 and close > df2')
月线回归支撑区域:top_temp.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3 and low < df2*1.2 and close > df2').loc[:,['macddif','macddea']]
top_temp.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3 and low < df2*1.2 and close > df2')
top_all.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3 and low < df2*1.2 and close > df2')
top_temp.query('macd >0 and macddif > macddea and macdlast2 > macdlast3 and close < df2')
top_all.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3 ')
top_temp.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3 ')
top_temp.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3')
top_all.query('macd >-1 and macddif < macddea and macdlast2 < macdlast3')
top_all.query('macd >-1 and macddif > macddea and macdlast1 > macdlast2' )
top_temp.query('macd >-1 and macddif > macddea and macdlast1 > macdlast2' )
top_temp.query('macddif > macddea and macdlast2 > macdlast3')
top_temp.query('macddif > macddea and macdlast4 > macdlast5')
top_temp.query('macddif > macddea and (macdlast4 < macdlast5 and lastp4d > lastp5d)')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d)')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lastp1d > lastp2d')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lastp1d > lastp2d and lasth1d >lasth2d')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lasth1d >lasth2d')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lasth1d >lasth2d and macdlast1 > macdlast2')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lasth1d >lasth2d and macdlast1 > macdlast2 and per1d >0')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lasth1d >lasth2d and macdlast1 > macdlast2 and per1d >0 and percent >0')
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lasth1d >lasth2d and macdlast1 > macdlast2 and per1d >0 and percent >0')[:10]
top_temp.query('(macdlast4 < macdlast5 and lastp4d > lastp5d) and lasth1d >lasth2d and macdlast1 > macdlast2 and per1d >0 and percent >0')[:20]
top_temp.query('percent >= 9')
top_temp.query('percent >= 4')
top_temp.query('percent >= 4 and high > max5')
top_temp.query('percent >= 4 and high > max5 and high >high4')
top_temp.query('percent >= 4 and high > max5 and high >hmax')
top_temp.query('percent >= 4 and high > max5 and high >hmax and per1d >=10 and per2d >=10')
top_temp.query('percent >= 4 and high > max5 and high >hmax and per1d >=10')
首阳启动:top_temp.query('percent >= 4 and high > max5 and high >hmax and lastp1d < ma51d*1.05')

top_temp.query('lastp1d > hmax and lastl1d < hmax')
top_temp.query('lastp1d > lastp2d and lasth1d > upper')
top_temp.query('per1d < 3 and per2d < 3 and per3d <3')
top_temp.query('per1d < 3 and per2d < 3 and per3d <3 and lastp1d > lastp2d')
top_temp.query('per1d < 3 and per2d < 3 and per3d <3 and lastp1d > lastp2d and lastp2d > lastp3d')
top_temp.query('per1d < 3 and per2d < 3 and per3d <3 and lastp1d > lastp2d and lastp2d > lastp3d and lastl1d < ma51d')
top_temp.query('lastp1d > high4 and per1d < 3 and per2d < 3 and per3d <3 and lastp1d > lastp2d and lastp2d > lastp3d and lastl1d < ma51d')
top_all.query('open > lasth1d*1.01 and low > lasth1d and boll > 0')
top_all.query('open > lasth1d*1.01 and low > lasth1d and boll > 0 and b1_v < 1')
top_all.query('lasto1d*0.999 < lastp1d < lasto1d*1.001')
top_all.query('lasto1d*0.989 < lastp1d < lasto1d*1.002')
top_all.query('lasto1d*0.998 < lastp1d < lasto1d*1.002')
top_all.query('lasto1d*0.996 < lastp1d < lasto1d*1.003')
top_all.query('lasto1d*0.996 < lastp1d < lasto1d*1.003 and ma201d < lastl1d <ma201d*1.03')
top_all.query('lasto1d*0.996 < lastp1d < lasto1d*1.003 and ma201d < lastl1d <ma201d*1.1')
top_all.query('lasto1d*0.996 < lastp1d < lasto1d*1.003 and ma201d < lastl1d <ma201d*1.1 and low > lastp1d*0.999')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and  lastl1d <ma201d*1.1 and low > lastp1d*0.999) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and  lastl1d <ma201d*1.1) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.995 < lastp1d < lasto1d*1.005 and  lastl1d <ma201d*1.1) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.995 < lastp1d < lasto1d*1.005 and  lastl1d <ma201d*1.1 and low > lasth1d) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.995 < lastp1d < lasto1d*1.005 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(boll > 0 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(fib > 0 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (b1_v < 1 and per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (per1d > 5 and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or (low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.995) or ((open > upper or per1d > 5) and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.99) or ((open > upper or per1d > 5) and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d*0.998) or ((open > upper or per1d > 5) and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d) or ((open > upper or per1d > 5) and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d) or ((open > hmax or per1d > 5) and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d) or ((open > max5 or per1d > 5) and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d) or ((open > lastp1d*1.03 or per1d > 5) and low >= lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d) or ((open > lastp1d*1.03 or per1d > 5 or open > hmax) and low >= lastp1d*0.998 and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999) or (lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and high > upper) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and close > upper) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and not name.str.contains("ST"))')
top_all.query('(b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and close > high4 ) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and close > hmax ) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and not name.str.contains("ST"))')
top_all.query('(lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and close > upper) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and close >lastp1d and not name.str.contains("ST"))')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and close > upper) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and close >lastp1d and not name.str.contains("ST"))')
top_all.query('(lasth1d > upper and lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and close > upper) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and close >lastp1d and not name.str.contains("ST"))')
top_all.query('(lasth1d < upper and lasto1d*0.996 < lastp1d < lasto1d*1.003 and lastl1d <ma201d*1.1 and low > lastp1d*0.999 and close > upper) or (b1_v < 1 and lastp1d > high4  and open > lasth1d and lasth1d > upper1 and lasth2d > upper2 and close > upper and close >lastp1d and not name.str.contains("ST"))')
top_all.query('top0 > 2')
top_all.query('top0 < 2 and percent > 5')
top_all.query('b1_v > 1')
top_all.query('b1_v > a1_v')
top_all.query('b1_v > a1_v and b1_v > 0')
top_all.query('percent >20')
top_all.query('lasth1d > hmax and lasth2d < hmax')
top_all.query('lasth1d > hmax and lasth2d < hmax and lasth2d >high4')
top_all.query('lasth1d > hmax and lasth2d < hmax and lastl1d < upper and high >upper')
top_all.query('lasth1d > max5 and lasth2d < hmax and lastl1d < upper and high >upper')
top_all.query('lasth1d > hmax and lasth2d < hmax and lastl1d < upper and high >upper and percent > 3')
top_all.query('((lasth1d > hmax and lasth2d < hmax ) or(lasth2d > upper and close >upper ) ) and lastl1d < upper and high >upper and percent > 3')
top_all.query('((lasth1d > hmax and lasth2d < hmax ) or(lasth2d > upper and close >upper ) ) and lastl1d < upper and high >upper')
top_all.query('((lasth1d > hmax and lasth2d < hmax ) or(lasth2d > upper and close >upper ) ) and lastl1d < upper and high >upper and percent > 1')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d) or ((open > lastp1d*1.03 or per1d > 5 or open > hmax) and low >= lastp1d*0.998 and not name.str.contains("ST")) and close >upper')
top_all.query('(ral > 2 and fib > 1 and lasto1d*0.99 < lastp1d < lasto1d*1.1 and  lastl1d <ma201d*1.1 and low > lasth1d) or ((open > lastp1d*1.03 or per1d > 5 or open > hmax) and low >= lastp1d*0.998 and not name.str.contains("ST")) and close > upper')
top_all.query('percent > 10')
top_all.query('percent > 9')
top_all.query('percent > 6')
top_all.query('percent > 6 and per2d < 5')
top_all.query('percent > 6 and 1 <per2d < 5')
top_all.query('lasth1d > lasth2d > lasth3d')
top_temp.query('lasth1d > lasth2d > lasth3d')
top_all.query('open > max5')
top_all.query('open > max5 and low > open*0.99')
top_all.query('open > high4 and low > open*0.99')
top_all.query('open > high4 and low > open*0.99 and open > lasth1d')
top_all.query('open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d')
top_all.query('open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and b1_v > 0')
top_all.query('open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0 and close >nclose')
top_all.query('lasth1d > upper1')
top_all.query('lasth1d > upper1 and lasth2d < upper2')
top_all_3d.query('lasth1d > lasth2d')
top_all_3d.query('lasth1d > lasth2d and high > upper')
top_all_m.query('lasth1d > lasth2d and high > upper')
top_all_m.query('lasth1d > lasth2d and lasth2d > lasth3d')
top_all_3d.query('lasth1d > lasth2d and lasth2d > lasth3d')
top_all.query('lasth1d > lasth2d and lasth2d > lasth3d')
top_all_m.query('lasth1d > lasth2d and lasth2d < ma51d')
top_all_w.query('lasth1d > lasth2d and lasth2d < ma51d')
top_all_3d.query('lasth1d > lasth2d and lasth2d < ma51d')
top_all_w.query('lasth1d > lasth2d and lasth2d < ma51d and high >upper')
top_all_w.query('lasth1d > lasth2d and lasth2d >lasth3d')
top_all_w.query('lasth1d > lasth2d and lasth2d >lasth3d and low >ma51d')
top_all_w.query('lasth1d > lasth2d and lasth2d >lasth3d and close > high4')
top_all_w.query('lasth1d > lasth2d and lasth2d >lasth3d and close > high4 and lasth2d < high4')
top_all_m.query('lasth1d > lasth2d and lasth2d >lasth3d and close > high4 and lasth2d < high4')
top_all.query('(low >= open and close > lastp1d) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('(low >= open and close > lastp1d and close > nhigh) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('(low >= open and close > lasth1d and close > nhigh) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('(low >= open and close > lastp1d and lasth1d > high4) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('(low >= open and close > lastp1d and lasth2d > high4) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('(low >= open and close > lastp1d and (per1d > 5 or per2d >5)) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('ral > 10 and topR > 1.1')
top_all.query('ral > 16 and topR > 1.1')
top_all.query('ral > 16 and topR > 1.1 and close > ma51d')
top_all.query('lasth1d > lasth2d > lasth3d and high < upper')
top_all.query('lasth1d > lasth2d > lasth3d and high < upper and per1d >0')
top_all.query('lasth1d > lasth2d > lasth3d and high > upper and per1d >0')
top_all.query('lasth1d > lasth2d > lasth3d and high > upper')
top_all.query('lasth1d > lasth2d and lastp1d > ma51d and lastp2d > ma52d and lastp3d > ma53d and high > upper')
top_all.query('lasth1d > lasth2d and lastp1d > ma51d and lastp2d > ma52d and lastp3d > ma53d and topR > 0')
top_all.query('lasth1d > lasth2d and lastp1d > ma51d and lastp2d > ma52d and lastp3d > ma53d')
top_all.query('(lasth1d > hmax or  lasth2d > hmax or lasth3d > hmax) and lastp1d > ma51d and high > upper')
top_all.query('((lasth1d > hmax and lasth2d < hmax ) or  (lasth2d > hmax and lasth3d < hmax ) or (lasth3d > hmax and lasth4d < hmax)) and lastp1d > ma51d and high > upper')
top_all.query('((lasth1d > high4 and lasth2d < high4 ) or  (lasth2d > high4 and lasth3d < high4 ))  and lastp1d > ma51d and high >upper')
top_all.query('((lasth1d > high4 and lasth2d < high4 ) or  (lasth2d > high4 and lasth3d < high4 ))  and lastp1d > ma51d and high >upper and lastl1d < ma51d *1.02')
top_all.query('lastp1d > lastp2d > lastp3d')
top_all.query('lastp1d > lastp2d > lastp3d and lasth1d > lasth2d > lasth3d')
top_all.query('lastp1d > lastp2d > lastp3d and lasth1d > lasth2d > lasth3d and lasth3d > ma53d')
top_all.query('lastp1d > lastp2d > lastp3d and lasth1d > lasth2d > lasth3d and lasth3d > ma53d and lasth1d > upper')
top_all.query('lastp1d > lastp2d > lastp3d and lasth1d > lasth2d > lasth3d and lasth3d > ma53d and high > upper')
top_all.query('lastp1d > lastp2d > lastp3d and lasth1d > lasth2d > lasth3d and lasth3d > ma53d and lasth1d > upper and boll < 3')
top_all.query('lastp1d > lastp2d > lastp3d and lasth1d > lasth2d > lasth3d and lasth3d > ma53d and lasth1d > upper and boll < 3 and close > lasth1d')
top_all.query('lastp1d > lastp2d > lastp3d and lasth1d > lasth2d > lasth3d and lasth3d > ma53d and lasth1d > upper and close > lasth1d')
top_all.query('percmax < 6 and per1d > percmax')
top_all.query('per1d > percmax')
top_all.query('per1d > percmax and high > upper')
top_all.query('per1d > percmax and high > upper and lasth1d < upper')
top_all.query('per1d > percmax and high > upper and lastp1d < upper')
top_all.query('per1d > percmax and lastp1d < upper')
top_all.query('per1d > percmax and lastp1d < upper and lasth1d > lasth2d > lasth3d')
top_all.query('per1d > percmax and low < ma51d *1.05')
top_all.query('per1d > percmax and low < ma51d *1.05 and close > hmax')
top_all.query('open > high4')
top_all.query('open > high4 and open > lasth2d')
top_all.query('open > high4 and open > lasth2d and open > lasth3d')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and open >=low')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and open >=low and close >=open')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and open >=low and percmax < 5')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and open >=low and percmax < 10')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and open >=low and percmax <=10')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and open >=low and percmax <=10 and ral > 3')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and open >=low and percmax <=10 and ral > 3 and percent > 1')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 ')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and (maxp < 5 or percent > maxp)')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and (maxp < 6 and percent > maxp)')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and  percent > maxp')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and  (open-lastp2d)/lastp2d > maxp')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and  ((open-lastp2d)/lastp2d) > maxp')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and  ((open-lastp2d)/lastp2d*100) > maxp')
top_all.query('open > high4 and open > lasth2d and open > lasth3d and open > lasth4d and open > upper2 and  ((close-lastp2d)/lastp2d*100) > maxp')
top_all.query('open > high4 and open > lasth1d and open > lasth2d and open > lasth3d and open > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp')
top_all.query('close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp')
top_all.query('close > high4 and close > lasth2d and close > lasth3d and close > lasth4d and close > upper2 and  ((close-lastp2d)/lastp2d*100) > maxp')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp')
top_all.query('lasth1d > upper1 and lasth2d >upper2')
top_all.query('lasth1d > upper1 and lasth2d >upper2 and high >boll')
top_all.query('lasth1d > upper1 and lasth2d >upper2 and high >boll and close > lastp1d')
top_all.query('lasth1d > upper1 and lasth2d >upper2 and high >boll and close < upper')
top_all.query('lasth1d > upper1 and lasth2d >upper2  and close < upper')
top_all.query('lasth1d > upper1 and lasth2d >upper2 and high >boll and percent > maxp')
top_all.query('lasth1d > upper1 and lasth1d >lasth2d   and high >boll and percent > maxp')
top_all.query('lasth1d  >lasth2d   and high > boll and percent > maxp')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d')
top_all.query('lasth1d  >lasth2d  and lastp2d > ma51d')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d and lastp1d > lastp2d*0.99')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d and lastp1d > lastp2d*0.99 and high > upper1')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d and lastp1d > lastp2d*0.99 and high > upper')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d and lastp1d > lastp2d*0.99 and lasth2d > lasth3d')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d and lastp1d > lastp2d*0.99 and lasth2d > lasth3d and lastp2d < upper2')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d and lastp1d > lastp2d*0.99 and lasth2d > lasth3d and lastp2d < upper2 and lasth1d >upper')
top_all.query('lasth1d  >lasth2d  and lastp1d > ma51d and lastp1d > lastp2d*0.99 and lasth2d > lasth3d and lastp2d < upper2 and lasth1d >upper')[-50:]
top_all.query('close > lastp2d')
top_all.query('close > lastp2d and percent > per2d')
top_all.query('close > lastp2d and percent > per2d')[-10:]
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 ')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and low > open*0.99')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (lasth1d > hmax and low > lastp1d))')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (lasth1d > hmax and low >= lastp1d))')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (per1d > 5 and low >= lastp1d))')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (per1d > 4 and low >= lastp1d))')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (per1d > 4 and low >= lastp1d)) and lastv1d > lastv2d')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (per1d > 4 and low >= lastp1d)) and lastv1d > lastv2d and percmax >5')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (per1d > 4 and low >= lastp1d)) and lastv1d > lastv2d and percmax >3')
top_all.query('close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (per1d > 4 and low >= lastp1d)) and lastv1d > lastv2d and percmax >2')
top_all.query('topR > 0')
top_all.query('topR > 0 and percmax > 5')
top_all.query('topR > 0 and percmax > 5 and fib > 10')
top_all.query('topR > 0 and percmax > 5 and fibl > 10')
top_all.query('topR > 0 and percmax > 5 and close < df2 *1.05' )
top_all.query('topR > 0 and percmax > 5 and close < df2 *1.1' )
top_all.query('topR > 0 and percmax > 5 and close < df2 *1.1 and low <=ma201d*1.03' )
top_all.query('topR > 0 and percmax > 5 and close < df2 *1.1 and ma201d < low <=ma201d*1.03' )
跳空回调ma201d:top_all.query('topR > 0 and percmax > 3 and close < df2 *1.1 and ma201d < low <=ma201d*1.03' )
top_all.query('lastp1d > lastp2d >lastp3d')
top_all.query('lastp1d > lastp2d >lastp3d and lasth1d > lasth2d >lasth3d')
top_all.query('lastp1d > lastp2d >lastp3d and lasth1d > lasth2d >lasth3d and high > high4')
top_all.query('lastp1d > lastp2d >lastp3d and lasth1d > lasth2d >lasth3d and high > max5')
top_all.query('lastp1d > lastp2d >lastp3d and lasth1d > lasth2d >lasth3d and high > high4 and max5 >high4')
top_all.query('lastp1d > lastp2d >lastp3d and lasth1d > lasth2d >lasth3d and high > high4 and max5 >high4 and high > lasth1d')
top_temp.query('high > max5 and lasth1d > lasth2d and lasth2d > lasth3d and lasth3d > lasth4d and percent > 0')
top_all.query(f'close > lastp1d and ral > 10 and fib > 0 and boll > 0 and close > lastp2d and percent > per2d and percent > lastdu4 and close >high4 and close > max5 and (low > open*0.99 or (per1d > 4 and low >= lastp1d))')
top_all.query('close > df2 and close > high4 and close > lasth2d and close > lasth3d and close > lasth4d and close > upper2 and  ((close-lastp2d)/lastp2d*100) > maxp and a1_v > 0')
top_all.query('close > df2 and close > high4 and close > lasth2d and close > lasth3d and close > lasth4d and close > upper2 and  ((close-lastp2d)/lastp2d*100) > maxp ')
top_all.query('(low >= open and close > lastp2d and (per2d > 5 or per3d >5) and a1_v > 0) or  open > high4 and (low > open*0.99 or low > lasth2d) and open > lasth2d and a1_v > 0')
top_all.query('a1_v < 1')
top_all.query('b1_v < 1')
top_temp.query('topR > 0')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and topR > 1')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and high >=hmax*0.9 and topR > 1')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and high >=hmax*0.9 and topR > 1 and lastp < hmax')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and high >=hmax*0.9 and topR > 1 and lastp1d < hmax')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and high >=hmax*0.9 and topR > 1 and lastp < hmax and high > lasth1d')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and high >=hmax*0.9 and topR > 1 and lastp < hmax and high >lasth1d')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and high >=hmax*0.9 and topR > 1 and lastp < hmax and high >lastp1d')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and high >=hmax*0.9 and topR > 1 and lastp < hmax and high >lasth2d')
top_all.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and topR > 1')
top_all.query('bandwidth < 10')
top_all.query('bandwidth < 5')
top_all.query('bandwidth > 9 and percmax > bandwidth')
top_all.query('bandwidth > 1 and percmax > bandwidth')
top_all.query('bandwidth > 1 and percent > bandwidth')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5)  and a1_v > 0) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5)  and a1_v > 0) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d ')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5)) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d ')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d ')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  open > high4 and (low > open*0.99 or low > lasth1d) and open > lasth1d and a1_v >0')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  open > high4 and (low > open*0.99 or low > lasth1d and close > upper) and open > lasth1d')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  open > high4 and (low > open*0.99 or low > lasth1d and low > upper) and open > lasth1d')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and open > hmax*0.99')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and open > hmax*0.98')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and open > max5')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and open > hmax*0.99 and open > max5')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and open > hmax*0.99 ')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and close > hmax*0.99 and close > max5')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and close > hmax*0.99 and close > max5 ')
top_all.query('close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and close > hmax*0.99 and close > max5 and open > upper1')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and close > hmax*0.99 and close > max5 ')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and close > hmax*0.99 and close > max5 and volume >5')
top_temp.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1 and  ((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10 and close > hmax*0.99 and close > max5 and volume >5')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 5')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and open > max5 and volume > 5')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) )')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 5))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 ')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) )')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth2d))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth1d))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth1d and close > open))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth1d and close >= open))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 9 and open > lasth1d and close >= open))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 3')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 4.5')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth1d and close >= open))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth1d and close >= open and low >open))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth1d and close >= open and low >open*0.999))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and open > hmax*0.99 and open > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) )')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and open > lasth1d and close >= open and low >open*0.999))')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and close > lasth1d  and low >lasth1d)) and a1_v > 0 ')
top_all.query('high > high4 and lasth1d < high4')
top_all.query('high > high4 and lasth1d < high4 and lastp1d < upper1')
top_all.query('high > high4 and lasth1d < high4 and lastp1d < upper1 and high > upper1')
top_all.query('high > high4 and lasth1d < high4 and lastp1d < upper1 and high > upper1 and low < open*0.99')
top_all.query('high > high4 and lasth1d < high4 and lastp1d < upper1 and high > upper1 and low > open*0.99')
top_all.query('lasth1d > high4 and lasth1d < high4 and lastp1d < upper1 and high > upper1 and low > open*0.99')
top_all.query('lasth1d > high4 and lasth2d < high4 and lastp1d < upper1 and high > upper1 and low > open*0.99')
top_all.query('close > high4 and lasth1d < high4 and lastp1d < upper1 and high > upper1 and low > open*0.99')
top_all.query('close > high4 and lasth1d < high4 and lastp1d < upper1 and high > upper1 and low > open*0.99 and red > 3')
top_all.query('close > high4 and lasth1d < high4 and lastp1d < upper1 and high > upper1 and low > open*0.99 and red > 1')
top_all.query('close > high4 and high > upper1 and low > open*0.99 and red > 3')
top_all.query('close > high4 and high > upper1 and low > open*0.99 and red > 3 and top15 > 1')
top_all.query('close > high4 and high > upper1 and low > open*0.99 and red > 3 and top15 > 1 and top10 >0')
top_all.query('close > high4 and high > upper1 and low > open*0.99 and red > 3 and top15 > 1 and percmax > 8')
top_all.query('close > high4 and high > upper1 and low > open*0.99 and red > 3 and top15 > 1 ')
top_all.query('percent > bandwidth')
top_all.query(' 6 < bandwidth  < 15')
top_all.query('percent > bandwidth and volume > 3')
top_all.query(' 6 < bandwidth  < 15 and volume > 2')
top_all.query(' 6 < bandwidth  < 15 and high > high4')
top_all.query(' 6 < bandwidth  < 15 and high > hmax')
top_all.query(' 6 < bandwidth  < 15 and high > hmax and percmax > 5')
top_all.query(' 10 < bandwidth  < 20 and high > hmax and percmax > 5')
top_all.query(' 10 < bandwidth  < 20 and high > hmax and percmax > 5 and high > upper1')
top_all.query(' 10 < bandwidth  < 20 and high > hmax and percmax > 5 and topR >0')
top_all.query(' 10 < bandwidth  < 20 and high > hmax and percmax > 5 and topR <1')
top_all.query('low < ma20d')
top_all.query('low < ma20d and high > max5')
top_all.query('low < ma20d and high > max5 and percent > 3')
top_all.query('low < ma20d and close > max5')
top_all.query('low < ma20d and close > max5 and ma51d > ma201d')
top_temp.query('close >0')
top_all.query('open > lasth1d')
top_all.query('close > ma51d and lasth1d > lasth2d')
top_all.query('close > ma20')
top_all.query('topR >0')
top_all.query('topR < 0')
top_all.query('topR < 0 and topR >0')
top_all.query('topR > 100')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 10 < bandwidth < 20) )')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp) )')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 5 ')
top_all.query('close > upper1 and close > df2')
top_all.query('close > upper1 and close > df2 and topR > 0')
top_all.query('close > upper1 and close > df2 and topR > 0 and low > ma51d')
top_all.query('close > upper1 and close > df2 and topR > 0 and close > upper1')
top_all.query('close > upper1 and close > df2 and topR > 0 and close > upper')
top_all.query('close > upper1 and close > df2 and topR > 0 and close > lasth1d ')
top_all.query('close > upper1 and close > df2 and topR > 0 and close > lasth1d and lasth1d > high4')
top_all.query('close > upper1 and close > df2 and topR > 0  and topU > 2')
top_all.query('close > upper1 and close > df2 and topR > 0  and topU > 2 and ma10d*1.05 > low > ma10d')
top_all.query('close > ma5d and close > df2 and topR > 0  and topU > 2 and ma10d*1.05 > low > ma10d')
top_all.query('close > ma5d and close > df2 and topR > 0  and topU > 2 and ma10d*1.05 > low > ma10d and open > lastp1d and low > lastl1d')
top_all.query('low <  ma201d  and close > ma201d')
top_all.query('low <  ma201d  and close > ma20d')
top_all.query('low <  ma20d  and close > ma20d')
top_all.query('low <  ma20d  and close > ma20d and high > high4')
top_all.query('low <  ma20d  and close > ma20d and high > high4 and 3 < bandwidth < 10')
top_all.query('topR >0 and ma20d *1.05 >low > ma20d')
top_all.query('topR >0 and low > upper')
top_all.query('lasth1d > upper1 and 	lasth2d > upper2')
top_all.query('lasth1d > upper1 and 	lasth2d > upper2 and lastp1d > ma51d')
top_all.query('lasth1d > upper1 and 	lasth2d > upper2 and lastp1d > ma51d and ma51d > ma201d')
top_all.query('lasth2d > upper2 and   lasth3d > upper3 and lastp1d > ma51d and ma51d > ma201d')
top_all.query('lasth2d > upper2 and   lasth3d > upper3 and lastp2d > ma51d and ma51d > ma201d')
top_all.query('topR >0 and boll > 2 and fibl > 3 and fib > 1 and red >1')
top_all.query('topR >0 and boll > 2 and fibl > 3 and fib > 1 and red >1 and low > ma5d')
top_all.query('topR >0 and boll > 2 and fibl > 3 and fib > 1 and red >1 and low > ma5d')[-50:]
top_all.query('topR >0 and boll > 2 and fibl > 3 and fib > 1 and red >1 and low > ma5d and bandwidth < 20')
top_all.query('topR >0 and boll > 2 and fibl > 3 and fib > 1 and red >1 and low > ma5d and 8 < bandwidth < 20')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red >1 and low > ma5d and 8 < bandwidth < 20')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red >1 and low > ma5d and 5 < bandwidth < 20')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red >0 and low > ma5d and 5 < bandwidth < 20')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red > 0 and low > ma5d and 8 < bandwidth < 20')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red > 0 and low > ma5d and top10 > 0')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red > 0 and low > ma5d and top10 > 0 and lastl1d > ma51d and lastl2d > ma52d')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red > 0 and low > ma5d  and lastl1d > ma51d and lastl2d > ma52d')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red > 0 and low > ma5d  and lastl1d > ma51d and lastl2d > ma52d and 3 < bandwidth < 12')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red > 0 and low > ma5d  and lastl1d > ma51d and lastl2d > ma52d and 3 < bandwidth < 15')
top_all.query('topR >0 and boll > 1 and fibl > 3 and fib > 1 and red > 0 and low > ma5d  and lastl1d > ma51d and lastl2d > ma52d ')
top_all.query('top10 > 0')
top_all.query('top10 > 0 and (per1d > 8 or per2d > 8 or per3d > 8)')
top_all.query('top10 > 0 and (per1d > 8 or per2d > 8 or per3d > 8) and close > hmax')
top_all.query('top10 > 0 and (per1d > 8 or per2d > 8 or per3d > 8) and close > hmax and lasth1d <hmax')
top_all.query('top10 > 0 and (per1d > 8 or per2d > 8 or per3d > 8) and close > hmax and lasth3d <hmax')
top_all.query('top10 > 0 and (per1d > 8 or per2d > 8 or per3d > 8) and close > hmax and lasth2d <hmax')
top_all.query('top10 > 0 and (per1d > 8 or per2d > 8 or per3d > 8) and close > hmax and lasth2d <hmax and maxp < 11')
top_all.query('top10 > 0 and (per1d > 8 or per2d > 8 or per3d > 8) and close > hmax and lasth2d <hmax and maxp < 10')
top_all.query('top10 > 0 and lasth3d > lasth2d ')
top_all.query('top10 > 0 and lasth3d > lasth2d and lastl3d > lastl2d ')
top_all.query('top10 > 0 and lasth3d > lasth2d and lastl3d > lastl2d and lasth2d > lasth1d ')
top_all.query('top10 > 0 and lasth3d > lasth2d and lastl3d > lastl2d and lasth2d > lasth1d and lastl2d > lastl1d')
top_all.query('top10 > 0 and lasth3d > lasth2d and lastl3d >  lastl2d > lastl1d')
top_all.query('top10 > 0 and lasth3d > lasth2d > lasth1d and lastl3d >  lastl2d > lastl1d')
top_all.query('top10 > 0 and lasth3d > lasth2d > lasth1d and lastl3d >  lastl2d > lastl1d and close > lastp1d')
top_all.query('top10 > 0 and lasth3d > lasth2d > lasth1d and lastl3d >  lastl2d > lastl1d and open > lastl1d')
top_all.query('top10 > 0 and lasth3d > lasth2d > lasth1d and lastl3d >  lastl2d > lastl1d and open > lastl1d and low > open*0.999')
top_all.query('top10 > 0 and lasth3d > lasth2d > lasth1d and lastl3d >  lastl2d > lastl1d and open > lastl1d and low > open*0.999 and close > lastp1d')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and open > lastl1d and low > open*0.999 and close > lastp1d')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and open > lastl1d  and close > lastp1d')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and open > lasth1d  and close > lastp1d')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and lasto2d > lasth3d')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and lasto2d > lasth3d and lasto1d > lasth2d')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and lasto2d > lasth3d and lasto1d > lasth2d and low > ma5d')
top_temp.query('top10 > 0 and lasth3d > lasth2d > lasth1d and lastl3d >  lastl2d > lastl1d and open > lastl1d and close > lastp1d')
top_all.query('top10 > 0 and lasth3d > lasth2d > lasth1d and lastl3d >  lastl2d > lastl1d and open > lastl1d and close > lastp1d')
top_temp.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and lasto2d > lasth3d and lasto1d > lasth2d and low > ma5d')
top_all.query('bandwidth >3')
top_all.query('3 <bandwidth')
top_all.query('bandwidth >0')
top_all.query('bandwidth > 0')
top_all.query('bandwidth > 0 ')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and lasto2d > lasth3d and lasto1d > lasth2d ')
top_all.query('top10 > 0 and lasth3d < lasth2d < lasth1d and lastl3d <  lastl2d < lastl1d and lasto2d > lasth3d ')
top_all.query('lasth1d > upper1 and lasth2d > upper2')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastl1d < ma10d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and low < ma10d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < upper')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < upper')[-50:]
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < upper')[:50]
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < upper and percmax > 10')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < upper and percmax < 10')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < upper and percmax > 20')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < upper and percmax > 4')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and close > lastp1d and low < ma10d')
top_all.query('5 < percmax < 20')
top_all.query('5 < percmax < 20 and lastl1d < ma201d and close > lastp1d')
top_all.query('ma20d < close < ma20d*1.02')
top_all.query('ma20d*1.01 < close < ma20d*1.5')
top_all.query('ma20d*1.01 < lastp1d < ma20d*1.5')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d and percent > 3')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d and percent > 3 and high > high4')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d and percent > 3 and high > max5')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d and percent > 3 and high > hmax')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax and high > upper')
top_all.query('ma20d*1.01 < lastp2d < ma20d*1.5 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax and high > upper and top10 > 1')
top_all.query('ma20d*1.01 < lastp1d < ma20d*1.5 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax and high > upper and top10 > 1')
top_all.query('ma20d*1.01 < lastl1d < ma20d*1.5 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax and high > upper and top10 > 1')
top_all.query('ma20d*1.01 < lastl1d < ma20d*1.05 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax and high > upper and top10 > 1')
top_all.query('ma20d*1.01 < lastl1d < ma20d*1.05 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax and high > upper ')
回踩上攻ma20d: top_all.query('ma10d*1.01 < lastl1d < ma10d*1.05 and close > lastp2d and percent > 3 and high > hmax and lastp3d < hmax and high > upper ')
top_all.query('lastp1d - hmax > 10')
top_all.query('lastp1d - hmax < 10')
top_all.query('0 < lastp1d - hmax < 10')
top_all.query('(lastp1d - hmax)/hmax*100 < 10 ')
top_all.query('(lastp1d - hmax)/hmax*100 < -30 ')
top_all.query('(lastp1d - hmax)/hmax*100 < -10 and ma10d < lastp1d < ma10d*1.05 ')
top_all.query('(lastp1d - hmax)/hmax*100 < -10 and ma10d < lastp1d < ma10d*1.05 and percent > 0')
top_all.query('(lastp1d - hmax)/hmax*100 < -10 and ma10d < lastp1d < ma10d*1.05 and percent > 0 and bandwidth > 10')
top_all.query('(lastp1d - hmax)/hmax*100 < -10 and ma10d < lastp1d < ma10d*1.05 and percent > 0 and bandwidth > 20')
top_all.query('(lasth1d > lasth2d and lasth1d > high4) or (high >= lasth1d > lasth2d > lasth3d and percent >3 and low < ma20d and close > ma20d)')
top_all.query('(lasth1d > lasth2d and lasth1d > high4 and high > max5) or (high >= lasth1d > lasth2d > lasth3d and percent >3 and low < ma20d and close > ma20d)')
top_all.query('(lasth1d > lasth2d and lasth1d > high4 and high > max5)')
top_all.query('(high >= lasth1d > lasth2d > lasth3d and percent >3 and low < ma20d and close > ma20d)')
top_all.query('close > df2  and low > ene and close > lastp1d and volume > 3 and boll > 1')
top_all.query('close > df2  and low > ene and close > lastp2d and volume > 3 and boll > 1')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d and lastl1d < ma51d*1.05 and perc1d >= perc2d')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d and lastl1d < ma51d*1.05')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d and lastl1d < ma51d*1.05 and perc1d >= perc2d and boll < 5')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d and lastl1d < ma51d*1.05 and perc1d >= perc2d and boll < -5')
top_all.query('0 < top10 < 3 ')
top_all.query('0 < top10 < 3 and high > hmax')
top_all.query('0 < top10 < 3 and high > hmax and lasth2d < hmax')
top_all.query('0 < top10 < 3 and high > hmax and lasth2d < hmax and high > upper1')
top_all.query('0 < top10 < 3 and high > hmax and lasth2d < hmax and high > upper1 and low < ma10d')
top_all.query('0 < top10 < 3 and high > hmax and lasth2d < hmax and high > upper1 and low < ma5d')
top_temp.query('low < ma5d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and topR > 0')
top_temp.query('low < ma5d  and ((lasth2d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and topR > 0')
top_all.query('high > hmax and lasth1d < hmax and high > high4 and low < ma5d')
top_all.query('high > hmax and lasth2d < hmax and high > high4 and low < ma5d')
top_all.query('high > hmax and lasth1d < hmax and high > high4 and low < ma5d and low < open*0.99 and close > lastp1d')
top_all.query('high > hmax and lasth1d < hmax and high > high4 and low < ma5d and low < open*0.99 and close > lastp2d')
top_all.query('high > hmax and lasth1d < hmax and high > high4 and low < ma5d and low < open*1.01 and close > lastp2d')
top_all.query('high > hmax and lasth2d < hmax and high > high4 and low < ma5d and low < open*1.01 and close > lastp2d')
top_all.query('high > hmax and lasth2d < hmax and high > high4 and low < ma5d and low < open*1.01 and close > lastp2d and high > upper')
top_all.query('high > hmax and lasth2d < hmax and high > high4 and low < ma5d and low < open*1.01 and close > lastp2d and high > upper1')
top_all.query('high > hmax and lasth2d < hmax and low < ma5d and low < open*1.01 and close > lastp2d and high > upper1')
top_all.query('high > hmax and lasth2d < hmax and low < ma5d and low < open*1.01 and close > lastp2d and high > high4 and volume > 1')
top_all.query('high > hmax and lasth2d < hmax and low < ma5d and low < open*1.01 and close > lastp2d and high > upper and volume > 1')
top_all.query('high > hmax and lasth2d < hmax and low < ma5d and low < open*1.01 and close > lastp2d and high > upper and volume > 2')
top_all.query('lasth1d > upper')
top_all.query('lasth1d > upper and close > hmax')
top_all.query('lasth1d > upper and close > hmax and high > upper')
top_all.query('lasth1d > upper and close > hmax and high > upper and lastp1d < upper1')
top_all.query('high > hmax and lasth1d < hmax and low < ma5d and low < open*1.01 and close > lastp1d and high > upper and volume > 1')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) ) and volume > 3')
top_all.query('high > hmax and lasth2d < hmax and low < ma5d and low < open*1.01 and close > lastp2d and high > upper and volume > 3')
top_all.query('high > hmax and lasth1d < hmax and low < ma5d and low < open*1.01 and close > lastp1d and high > upper and volume > 2')
top_all.query('high > hmax and lasth1d < hmax and low < ma5d and low > open**0.99 and close > lastp1d and high > upper and volume > 2')
top_all.query('close > upper and (lasth1d > upper1 and lastp2d < upper2) and low > open**0.99 and close > lastp1d and high > upper and volume > 2')
top_all.query('(low >= open*0.99 and close > lasth1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 and a1_v > 0 ) or  open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('(low >= open*0.99 and close > lasth1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 and a1_v > 0 ) or  open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d ')
top_all.query('(low >= open*0.99 and close > lasth1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 and a1_v > 0 ) or  open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d and close > nclose')
top_all.query('(low >= open*0.99 and close > lasth1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 and a1_v > 0 ) or  (open > high4 and (low > open*0.999 or low > lasth1d)) and open > lasth1d ')
top_all.query('(low >= open*0.99 and close > lasth1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 and a1_v > 0 )')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d and a1_v > 0')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d and close > open')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d and close >= open')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d ')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and macdlast1 > macdlast2')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and boll > 0')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d ')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and close > lasth1d')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and close > lasth1d and high > upper')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and close > lasth1d and (high > upper or boll > 1)')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and close > lasth1d and (high > upper or boll > 1) and close > hmax')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and close > lasth1d and (high > upper or boll > 1) and close > open*1.01')
top_all.query('(low >= open*0.99 and close > lasth1d and (per1d > 5 or per2d >5) ) or  open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d ')
top_all.query('open > high4 and (low > open*0.999 or low > lasth1d) and open > lastp1d and close > lasth1d and (high > upper or boll > 1) and close > open*1.01 and a1_v > 0')
top_all.query('high > hmax and lasth1d < hmax and high > high4 and low < ma5d and low > open*0.99 and close > lastp1d and high > upper1 and volume > 2')
top_all.query('(low >= open and close > lastp1d and (per1d > 5 or per2d >5) ) or  open > high4 and (low > open*0.999 or low > lasth1d) and open > lasth1d ')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  (open > high4 and (low > open*0.999 or low > lasth1d and low > upper) and open > lasth1d) and a1_v > 0')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  (open > high4 and (low > open*0.999 or low > lasth1d and low > upper) and open > lasth1d)')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and close > lasth1d  and low >lasth1d)) ')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > hmax*0.99 and close > max5 and volume > 4.5 and ((((close-lastp1d)/lastp1d*100) > maxp and 3 < bandwidth < 10) or (per1d > 8 and close > lasth1d  and low >lasth1d))')
top_all.query('boll > 0')
top_all.query('boll > 0 and lasth1d < upper1')
top_all.query('boll > 0 and lasth1d < upper1 and high > high4')
top_all.query('boll > 0 and lasth1d < upper1 and high > high4 and lastl1d < ma51d*1.02')
top_all.query('boll > 0 and lasth1d < upper1 and high > high4 and lastl1d < ma51d*1.02 ')
top_all.query('boll > 0 and lasth1d > upper1 and high > high4 and lastl1d < ma51d*1.02 ')
top_all.query('boll > 0 and lasth1d > upper1 and lasth2d > upper2 and high > high4 and lastl1d < ma51d*1.02')
top_all.query('boll > 0 and lasth1d > upper1 and lasth2d > upper2 and high > high4 ')
top_all.query('boll > 0 and lasth1d > upper1 and lasth2d > upper2 and high > high4')
top_all.query('boll > 0 and lasth1d > upper1 and lasth2d > upper2')
top_all.query('boll > 0 and lasth1d > upper1 and lasth2d > upper2 and bandwidth > 10 and high > high4 ')
top_all.query('(lasth1d > upper1 and lasth2d > upper2 or (lasth1d > lasth2d > lasth3d )) and bandwidth > 10 and high > high4 ')
top_temp.query('high > max5 and lasth1d > lasth2d and lasth2d > lasth3d and lasth3d > lasth4d and percent > 0 and lastp1d < upper1')
top_temp.query('high > max5 and lasth1d > lasth2d and lasth2d > lasth3d and lasth3d > lasth4d and percent > 0 and lastp1d < upper1 and high > upper')
top_temp.query('high > max5 and lasth1d > lasth2d and lasth2d > lasth3d and lasth3d > lasth4d and percent > 0 and low > upper')
top_temp.query('close > df2  and low > ene and close > lastp1d and volume > 3 and boll > 1')
top_all.query('high > high.shift(1) and (( low > low.shift(1) and close > close.shift(1)*1.01) or (close > upper and close > open*1.01) or (low >= open*0.992 and close >= close.shift(1)*1.005 ))')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d ')
top_temp.query('boll>0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d ')
top_all.query('topR >0 and red > 2')
top_all.query('topR >0 and red > 2 and high > high4')
top_all.query('topR >0 and red > 2 and high > high4 and lasth1d < upper1')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5  and topR > 1')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5  and topR > 0')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d  and perc1d >= perc2d')
top_all.query('lasth2d < upper1')
top_all.query('lasth2d < upper1 and high > upper1')
top_all.query('lasth2d < upper1 and high > upper1 and lastp2d < hmax ')
top_all.query('lasth2d < upper1 and high > upper1 and lastp2d < hmax and high > hmax')
top_all.query('lasth2d < upper1 and lasth3d < upper2 and  high > upper1 and lastp2d < hmax and high > hmax ')
top_all.query('lasth2d < upper1 and lasth3d < upper2 and  high > upper1 and lastp2d < hmax and high > hmax and topR >0')
top_all.query('topR >0 and red >0 and low < ma10d')
top_all.query('topR >0 and red >0 and low < ma10d and percent > 3')
top_all.query('topR >0 and red >0 and low < ma20d and percent > 3')
top_all.query('topR >0 and red >0 and low < ma20d and close > ma20d')
top_all.query('high > high4 and high > max5')
top_all.query('high > high4 and high > max5 and close < max5')
top_all.query('high > high4 and high > max5 and close < max5 and high > upper')
top_all.query('high > high4 and high > max5 and close < max5 and high > upper and low < ma51d')
top_all.query('high > high4 and high > max5  and high > upper and low < ma51d')
top_all.query('high > high4 and high > max5  and high > upper and lastl1d < ma51d')
top_all.query('high > high4 and high > max5  and high < upper and lastl1d < ma51d')
top_all.query('high > high4 and high > max5  and high < upper and lastl1d < ma51d and close > ma201d')
top_all.query('high > high4 and high > max5  and high < upper and lastl1d < ma51d and close < ma201d')
top_all.query('high > high4 and high > max5  and high < upper and lastl1d < ma51d and close < ma10d')
top_all.query('high > high4 and high > max5  and high < upper and lastl1d < ma51d and close < ma20d')
top_all.query('high > high4 and high > max5  and high < upper and lastl1d < ma51d and close > ma20d')
top_all.query('high > high4 and high > max5  and high < upper and lastl1d < ma51d and low > ma10d')
top_all.query('high > high4 and high > max5  and high < upper and high > lasth1d and lasth1d > lasth2d and lastl1d > lastl2d')
top_all.query('high > high4 and high > max5  and high > lasth1d and lasth1d > lasth2d and lastl1d > lastl2d')
top_all.query('high > high4 and high > max5  and lasth1d > lasth2d and lastl1d > lastl2d')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and high > upper')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and lastp1d > lasth2d')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and lastp1d > lasth2d and lasth1d > upper')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and lastp1d > lasth2d and lasth1d > upper1')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and lastp1d > lasth2d and lasth1d > upper1 and top10 >1')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and lastp1d > lasth2d and lasth1d > upper1 and red > 1')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and lastp1d > lasth2d and lasth1d > upper1 and red > 1 and top10 > 1')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasth2d > lasth3d  and lastl2d > lastl3d and lastp1d > lasth2d and lasth1d > upper1 and red > 1 and topR > 0')
top_all.query('low > 2*(high+low+open+2*close)/5-high')
top_all.query('low < (2*(high+low+open+2*close)/5-high)*1.02 ' )
top_all.query('low > (2*(high+low+open+2*close)/5-high)*1.02 ')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastl1d > lastl2d > lastl3d ')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastl1d > lastl2d > lastl3d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lastl1d > lastl2d > lastl3d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lastl1d > lastl2d > lastl3d')[-50:]
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lastl1d > lastl2d > lastl3d and close > lasth2d')[-50:]
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lastl1d > lastl2d > lastl3d and close > lasth2d')
top_all.query('lasth1d > upper1 and lasth2d < upper2 and lastl1d > lastl2d > lastl3d and close > lasth2d')
top_all.query('lasth1d > upper1 and lasth2d < upper2 and lastl1d > lastl2d > lastl3d and close > lasth2d and high > high4')
top_all.query('lasth1d > upper1 and lasth2d < upper2 and lastl1d > lastl2d > lastl3d and close > lasth2d and high > max5')
top_all.query('lasth1d > upper1 and lasth2d < upper2 and lastl1d > lastl2d > lastl3d and close > lasth2d and high > hmax')
top_all.query('lasth1d > upper1 and lasth2d < upper2 and lastl1d > lastl2d > lastl3d and close > lasth2d ')
top_all.query('red > 1')
top_all.query('red > 5 and close > upper')
top_all.query('red > 5 and close > upper1')
top_all_3d.query('red > 5 and close > upper1')
top_all_3d.query('red > 2 and close > upper1')
top_all_3d.query('red > 3 and close > upper1')
top_all_3d.query('red > 3 and close > upper1 and close > lastp2d')
top_all_3d.query('red > 3 and close > upper1 and close > lastp2d and macdlast1 > 0')
top_temp.query('high > high4 and lasth1d > lasth2d and lasth2d > lasth3d and low <= ma5d*1.02 and percent > 0')
top_temp.query('high > high4 and lasth1d > lasth2d and lasth2d > lasth3d  and percent > 0')
top_temp.query('(high > high4 and lasth1d > lasth2d and lasth2d > lasth3d  and percent > 0)')
top_temp.query('(high > high4 and lasth1d > lasth2d and lasth2d > lasth3d  and percent > 0) or high > lasth1d')
top_temp.query('(high > high4 and lasth1d > lasth2d and lasth2d > lasth3d  and percent > 0) or close > lastp1d ')
top_temp.query('(high > high4 and lasth1d > lasth2d and lasth2d > lasth3d  and percent > 0) or (close > lastp1d and close > max5) ')
top_temp.query('(high > high4 and lasth1d > lasth2d and lasth2d > lasth3d  and percent > 0 and close > open)')
top_temp.query('(high > high4 and lasth1d > lasth2d  > lasth3d  and percent > 0 and close > open)')
top_temp.query('(high > high4 and lasth1d > upper  and percent > 0 and close > open)')
top_temp.query('(high > high4 and high > upper  and percent > 0 and close > open)')
top_temp.query('(high > high4 and lasth1d > lasth2d  > lasth3d > upper  and percent > 0 and close > open)')
top_temp.query('(high > high4 and lasth1d > lasth2d  and percent > 0 and close > open)')
top_temp.query('(high > high4 and lasth1d > lasth2d  and percent > 0 and close > open and top10 >0)')
top_all.query('boll >5')
top_all.query('boll >5 and top10 >0')
top_all.query('boll >5 and top10 >0 and fibl >= boll -1')
top_all.query('boll >5 and top10 >0 and fibl >= boll-1')
top_all.query('boll >5 and top10 >0 and fibl >= boll')
top_all.query('boll >3 and top10 >0 and fibl >= boll')
top_all.query('boll >2 and top10 >0 and fibl >= boll')
top_all.query('boll >1 and top10 >0 and fibl >= boll')
top_all.query('boll > 3 and bandwidth < 10')
top_all.query('boll > 3 and close > high4')
top_all.query('boll > 3 and close > high4 and boll >=fibl')
top_all.query('close > high4 and boll >=fibl')
top_all.query('close > high4 and boll >=fibl > 0')
top_all.query('close > high4 and boll >=fibl > 2')
top_all.query('close > high4 and boll >=fibl > 1')
top_all.query('close > high4 and boll >=fibl > 1')[:50]
top_all.query('close > high4 and boll >=fibl > 9')
top_all.query('close > high4 and boll >=fibl > 1 and boll > 8')
top_all.query('close > high4 and boll >=fibl > 1 and boll > 9')
top_all.query('close > high4 and boll >=fibl > 1 and red > 1')
top_all.query('boll >=fibl > 1 and red > 1')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp1d')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp2d')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp2d and dff > 100')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp2d and dff > 50')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp2d and dff > 50 and high > upper')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp2d and dff > 100 and high > upper')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp2d and high > upper')
top_all.query('boll >=fibl > 1 and red > 3 and close > lastp2d and high > upper')
top_all.query('boll >=fibl > 1 and red > 3 and close > lastp2d and high > upper')[-50:]
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper')[-50:]
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and ma10d < low  < ma10d *1.02 ')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper')
top_all.query('boll >=fibl-1 > 1 and red > 2 and close > lastp2d and high > upper')
top_all.query('boll >=fibl-1 > 3 and red > 2 and close > lastp2d and high > upper')
top_temp.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d                         and  lasth3d > lasth4d  and lastl3d > lastl4d  and low >ma51d and (topR > 0 or (perc1d > 1 and perc2d > 0)) and percent > 0')
top_all.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d                         and  lasth3d > lasth4d  and lastl3d > lastl4d  and low >ma51d and (topR > 0 or (perc1d > 1 and perc2d > 0)) and percent > 0')
top_all.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d                         and  lasth3d > lasth4d  and lastl3d > lastl4d  and low >ma51d and (topR > 0 or (perc1d > 1 and perc2d > 0)) ')
top_all.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d                         and  lasth3d > lasth4d  and lastl3d > lastl4d  and low >ma51d ')
top_all.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d                         and  lasth3d > lasth4d  and lastl3d > lastl4d > ma51d and low >ma51d ')
top_all.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d                         and  lasth3d > lasth4d  and lastl3d > lastl4d > ma54d and low >ma51d ')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d  and perc1d >= perc2d and high > hmax')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d  and perc1d >= perc2d and high > hmax and lasth2d < hmax')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d  and perc1d >= perc2d and high > hmax and lasth2d < hmax and lasth1d > upper')
top_temp.query('boll>0 and perc1d >=0 and perc2d >=0 and perc3d >= 0 and ma51d > ma201d  and perc1d >= perc2d and high > hmax and lasth2d < hmax and lasth1d > upper and lasth3d < upper3')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper and lasth1d < upper1')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper and lasth1d < upper')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high < upper')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high < upper and lastp1d > lasth2d')
top_all.query('lastl1d > ma51d and lastl2d > ma52d')
top_all.query('lastl1d > ma51d and lastl2d > ma52d and lastl3d >ma53d')
top_all.query('lastl1d > ma51d and lastl2d > ma52d and lastl3d >ma53d and ma5d < low < ma5d*1.1')
top_all.query('lastl1d > ma51d and lastl2d > ma52d and lastl3d >ma53d and ma10d < low < ma10d*1.1')
top_all.query('lastl1d > ma51d and lastl2d > ma52d and lastl3d >ma53d and ma10d < low < ma10d*1.05')
top_all.query('lastl1d > lastl2d > lastl3d  and lasth1d > lasth2d and ma10d < low < ma10d*1.05')
top_all.query('close > max5')
top_all.query('close > max5  and low  < ma5d')
top_all.query('close > max5  and low  < ma5d and close > lastp1d')
top_all.query('close > max5  and low  < ma5d and close > lastp1d and lastp1d < lastp2d')
top_all.query('close > max5  and low  < ma5d and close > lastp1d and lastp1d < lastp2d and high > upper')
top_all.query('top10 >0')
top_all.query('top10 >0 and topR >0')
top_all.query('boll > 0 and ma10d < low < ma10d*1.05')
top_all.query('boll > 0 and ma10d < low < ma10d*1.05 and close > open')
top_all.query('boll > 0 and ma10d < low < ma10d*1.05 and close > open and close >nclose')
top_all.query('boll > 0 and ma10d < low < ma10d*1.05 and close > open and close <nclose')
top_all.query('boll > 0 and ma10d < low < ma10d*1.05 and close <nclose')
top_all.query('boll > 0 and ma10d < low < ma10d*1.05 and close <= nclose')
top_temp.query('boll > 0 and ma10d < low < ma10d*1.05 and close > open')
top_all.query('boll > 0 and ma10d < low < ma10d*1.05 and close > nclose')
top_all.query('close > nclose')
top_all.query('close > nclose and open >=low')
top_all.query('close > nclose and open >= nlow')
top_all.query('close > nclose and open >= nlow and low >=nlow')
top_all.query('close > nclose and low >=nlow')
top_all.query('close > nclose and low >=nlow and close > df2')
top_all.query('close > nclose and low >=nlow and close > df2 and bandwidth < 20')
top_all.query('close > nclose and low >=nlow and close > df2 and bandwidth < 20 and top10>0')
top_all.query('close > nclose and low >=nlow and close > df2 and top10>0')
top_all.query('close > nclose and low >=nlow and close > df2 and top10 > 0')
top_all.query('close > nclose and low >=nlow and close > df2 and top10 > 0 and red >1')
top_all.query('close > nclose and low >=nlow and close > df2 and top10 > 0 and red > 1 and fibl > 1 and boll >1')
top_all.query('close > nclose and low >=nlow and close > df2 and top10 > 0 and red > 1 and fibl > 1 and boll >1 and topR >0')
top_all.query('close > nclose and low >=nlow and red > 3 and fibl > 1 and boll >1')
top_all.query('close > nclose and low >=nlow and nlow > open*0.99 and red > 3 and fibl > 1 and boll >1')
top_all.query('close > nclose and nlow > open*0.99 and red > 3 and fibl > 1 and boll >1')
top_all.query('lasth1d > lasth2d')
top_all.query('lasth1d > lasth2d and low < ma51d*1.05')
top_all.query('lasth1d > lasth2d and low < ma51d*1.05 and high < upper ')
top_all.query('lasth1d > lasth2d and low < ma51d*1.05 and high < upper and volume > 1')
top_all.query('lasth1d > lasth2d and low < ma51d*1.05 and high < upper and volume > 1 and lasth2d > upper2')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and high < upper and volume > 1 and lasth2d > upper2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d and high < upper and volume > 1 and lasth2d > upper2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.99 and high < upper and volume > 1 and lasth2d > upper2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.99 and volume > 1 and lasth2d > upper2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.97 and volume > 1 and lasth2d > upper2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.97 and volume > 1 and lasth2d > upper2 and boll > 1')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.95 and volume > 1 and lasth2d > upper2 and boll > 1')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 1')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 5')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 6')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 1 and red >2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 2 and red >2')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 2 and red >2 and close > max5')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 2 and red >2 and close > max5 and close >=high')
top_all.query('lasth1d > lasth2d and lastl1d > lastp2d*0.9 and lasth2d > upper2 and boll > 2 and red >2 and close > max5 and high > lasth1d')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d and lasth2d > upper2 and boll > 2 and red >2 and close > max5 and high > lasth1d')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5 and high > lasth1d')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5 and high > lasth1d')[-50:]
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5 and high > lasth2d')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > hmax')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5 and per1d > per2d')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5 and per1d > per2d > per3d')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5 and per2d > per3d')
top_all.query('lasth2d > lasth3d and lastl2d > lastl3d  and boll > 2 and red >2 and close > max5 and per1d > per2d > per3d')[-50:]
top_all.query('per1d > 0 and lastp1d > lastp2d')
top_all.query('per1d > 0 and lastp1d > lastp2d and boll >0')
top_all.query('lastp1d > max5')
top_all.query('lasth1d >= high4 and high4 >=max5')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and close > df2')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and lasth2d < high4')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and lastp2d < high4')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 3')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 3 and ra >0')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 5')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.99')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992 and per1d >0')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992 and lastp1d >= lasth1d*0.98')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992 and lastl1d > ma51d')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992 and lastl1d > ma51d and lastl2d > ma52d')
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992 and lastl1d > ma51d')[:-50]
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992 and lastl1d > ma51d')[-50:]
top_all.query('lasth1d >= high4 and high4 >=max5 and boll>0 and high4 > df2 and volume > 2 and ra >0 and fibl > 1 and ral > 5 and low >=nlow and nlow >=open*0.992 and lastl1d > ma10d')
top_all.query('topR >0 and low > lasth1d')
top_all.query('topR >0 and open > lasth1d')
top_all.query
top_all.query('boll > 1')
top_all.query('boll > 1 and lasth1d > lasth2d')
top_all.query('boll > 1 and lasth1d > lasth2d and lasth1d >=high4')
top_all.query('boll > 1 and lasth1d > lasth2d and lasth1d >=high4 and lastl1d < ma51d')
top_all.query('boll > 1 and lasth1d > lasth2d and lasth1d >=high4 and lastl1d < ma51d and close > lastp1d')
top_all.query('boll > 1 and lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasth1d >=high4 and lastl1d < ma51d and close > lastp1d ')
top_all.query('boll > 2 and per1d > 0 and per2d >0 and per3d >0')
top_all.query('boll > 2 and per1d > 0 and per2d >0 and per3d >0')[-50:]
top_all.query('boll > 2 and per1d > 0 and per2d >0 and per3d >0 and lasth1d > lasth2d')
top_all.query('boll > 2 and per1d > 0 and per2d >0 and per3d >0 and lasth1d > lasth2d and close >=high*0.99')
top_all.query('boll > 3 and per1d > 0 and per2d >0 and per3d >0 and lasth1d > lasth2d and close >=high*0.99')
top_all.query('boll > 2 and per1d > 0  and lasth1d > upper1 and lasth2d > upper2 and close >=high*0.99')
top_all.query('boll > 2 and per1d > 0  and lasth1d > upper1 and lasth2d > upper2 and close >=high*0.99 and category.str.contains("芯片")')
top_all.query('boll > 3 and category.str.contains("芯片")')
top_all.query('boll > 3 and category.str.contains("peek")')
top_all.query('boll > 3 and category.str.contains("pet")')
top_all.query('boll > 3 and category.str.contains("飞机")')
top_all.query('boll > 3')
top_all.query('boll > 3 and category.str.contains("专精特新")')
top_all.query('boll > 3 and lastp1d > lastp2d and category.str.contains("飞机")')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper and category.str.contains("专精特新")')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper ')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper  and category.str.contains("专精特新")')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper and lasth2d < upper2')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and high > upper and lasth2d < upper2 and per1d > 5')
top_all.query('boll >=fibl > 1 and red > 2 and per1d > 5')
top_all.query('close > high*0.99')
top_all.query('close > high*0.99 and lasth1d < upper1')
top_all.query('close > high*0.99 and lasth2d < upper2')
top_all.query('close > high*0.99 and lasth2d < upper2 and high > upper')
top_all.query('lasth2d > lasth3d > lasth4d and boll >0')
top_all.query('lasth2d > lasth3d > lasth4d and boll >1 and red >1')
top_all.query('lasth2d > lasth3d > lasth4d and boll >1 and red >1 and lastv1d > lastv2d')
top_all.query('lasth2d > lasth3d > lasth4d and boll >1 and red >1 and lasth1d > upper')
top_all.query('lasth2d > lasth3d > lasth4d and boll >1 and red >1 and (lastv1d > lastv2d or lastv2d > lastv3d)')
top_all.query('lasth2d > lasth3d > lasth4d and boll >1 and red >1 and (lastv1d > lastv2d or lastv2d > lastv3d) and lasth1d > upper')
top_all.query('lasth2d > lasth3d > lasth4d and boll >1 and red >1 and (lastv1d > lastv2d or lastv2d > lastv3d) and lasth1d > upper and high > max5')
top_all.query('lasth2d > lasth3d > lasth4d and boll >1 and red >1 and (lastv1d > lastv2d or lastv2d > lastv3d) and lasth1d > upper and lastl1d < ma51d')
top_all.query('per1d > 0 and per2d > 0 and per3d >0')
top_all.query('per1d > 0 and per2d > 0 and per3d >0 and per4d>0')
top_all.query('per1d >0 and lasth1d > upper and lasth2d < upper2')
top_all.query('per1d >0 and lasth1d > upper and lasth2d < upper2 and lastv1d > lastv2d')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d and close > lastp2d')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d and close > lastp1d')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d and close > lastp1d')[-50:]
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d and close > lastp2d')[-50:]
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d and close > lastp2d and close >upper')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d and close > lastp2d and low >=open*0.99')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastv1d > lastv2d and close > lastp2d and low >=open*0.99 and close > upper')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastp3d*0.99 < lasto3d < lastp3d*1.02')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastp3d*0.99 < lasto3d < lastp3d*1.02 and lastv1d > lastv2d')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.02 and lastp3d*0.99 < lasto3d < lastp3d*1.02 and lastv1d > lastv2d and close > lastp2d')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.02 and close > lastp1d')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.02 and close > lastp2d')
top_all.query('lastp1d*0.99 < lasto1d < lastp2d*1.02 and close > lastp2d')
top_all.query('lastp1d*0.99 < lasto2d < lastp2d*1.02 and close > lastp2d')
top_all.query('lastp1d*0.99 < lasto2d < lastp2d*1.02 and close > lastp2d and low < ma201d')
top_all.query('lastp1d*0.99 < lasto2d < lastp2d*1.02 and close > lastp2d and low < ma201d and lastv1d > lastv2d')
top_all.query('per1d > 0 and per2d >0 and per3d >0')
top_all.query('per1d > 0 and per2d >0 and per3d >0 and lasth2d > upper')
top_all.query('per1d > 0 and per2d >0 and per3d >0 and lasth2d > upper and percent < 10')
top_all.query('10 > per1d > 0 and 10 > per2d >0 and 10 >per3d >0 and lasth2d > upper')
top_all.query('10 > per1d > 0 and 10 > per2d >0 and 10 >per3d >0 and lasth1d > upper')
top_all.query('10 > per1d > 0 and 10 > per2d >0 and 10 >per3d >0 and lasth1d > upper and close > hmax')
top_all.query('15 > per1d > 0 and 15 > per2d >0 and 15 >per3d >0 and lasth2d > upper')
top_all.query('15 > per1d > 0 and 15 > per2d >0 and 15 >per3d >0 and close > hmax')
top_all.query('15 > per1d > 0 and 15 > per2d >0 and 15 >per3d >0 and close > high4')
top_all.query('15 > per1d > 0 and 15 > per2d >0 and 15 >per3d >0 and close > hmax and lasth1d < hmax')
top_all.query('15 > per1d > 0 and 15 > per2d >0 and 15 >per3d >0 and close > hmax and lasth1d < high4')
top_all.query('15 > per1d > 0 and 15 > per2d >0 and 15 >per3d >0 and close > hmax and low < ma51d')
top_all.query('top10 < 3 and per1d > 5')
top_all.query('top10 < 3 and per1d > 5 and high > hmax')
top_all.query('top10 < 3 and per1d > 5 and high > hmax and lasth2d < hmax')
top_all.query('top10 < 3 and lasth1d > upper and lasth2d >upper2')
top_all.query('top10 < 3 and lasth1d > upper and lasth2d >upper2 and lasth3d > upper3')
top_all.query('top10 < 3 and lasth1d > upper and lasth2d >upper2 and lasth3d > upper3 and lasth4d > upper4')
top_all.query('top10 > 1')
top_all.query('boll >=fibl > 1 and red > 1 and close > lastp2d and high > upper and lasth2d > lasth3d')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.02')
top_all.query('lastp1d > lastp2d')
top_all.query('lastp1d > lastp2d > ma51d and per1d > 2')
top_all.query('lastp1d > lastp2d > ma51d and per1d > 2 and lasth1d > upper')
top_all.query('lastp1d > lastp2d > ma51d and per1d > 2 and lastp1d > upper')
top_all.query('lastp1d > lastp2d > ma51d and per1d > 2 and lasth1d > upper')[-50:]
top_all.query('lastp1d > lastp2d > ma51d and per1d > 2 and lasth1d > upper and boll > 1')
top_all.query('lastp1d > lastp2d > ma51d and per1d > 2 and lasth1d > upper and boll > 1 and red > 2')
top_all.query('lastp1d > lastp2d > ma51d and per1d > 2 and lasth1d > upper and boll > 2 and red > 2')
top_all.query('lastp1d > lastp2d > ma51d and lastl1d < ma51d and per1d > 2 and lasth1d > upper and boll > 1 and red > 2')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and lastl2d > upper')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and lastl2d > upper2')
top_all.query('boll >=fibl > 1 and red > 2 and close > lastp2d and lasth1d > lasth2d >lasth3d')
top_temp.query('close > df2  and low > ene and close > lastp1d and volume > 3 and boll > 1 and macdlast1 > macdlast2')
top_temp.query('close > df2  and low > ene and close > lastp1d and boll > 1 and macdlast1 > macdlast2')
top_temp.query('close > df2  and low > ene and close > lastp1d and boll > 1 and macdlast1 > macdlast2 > macdlast3')
top_temp.query('close > df2  and low > ene and close > lastp1d and boll > 1 and macdlast1 > macdlast2 > macdlast3 and (macdlast2 < 0 or macdlast3 <0 )')
top_temp.query('close > df2  and low > ene and boll > 1 and macdlast1 > macdlast2 > macdlast3 and (macdlast2 < 0 or macdlast3 <0 )')
top_temp.query('low > ene and boll > 1 and macdlast1 > macdlast2 > macdlast3 and (macdlast2 < 0 or macdlast3 <0 )')
top_temp.query('low > ene and boll > 1 and macdlast1 > macdlast2 > macdlast3 and (macdlast2 < 0 or macdlast3 < 0 or macdlast4 < 0)')
top_temp.query('low > ene and boll > 1 and macdlast1 > macdlast2 > macdlast3 and (macdlast2 < 0 or macdlast3 < 0 or macdlast4 < 0 or macdlast5 < 0)')
top_temp.query('low > ene and boll > 1 and macdlast1 > macdlast2 > macdlast3 and (macdlast2 < 0 or macdlast3 < 0 or macdlast4 < 0 or macdlast5 < 0 or macdlast6 <0)')
top_all.query('per1d > per2d > per3d')
top_all.query('per1d > per2d > per3d and per2d < 0 and per3d < 0')
top_all.query('per1d > per2d > per3d')[-10:]
top_all.query('per1d > per2d > per3d and per2d < 0 and per3d < 0 and close > lastp1d')
top_all.query('per1d > per2d > per3d and per2d < 0 and per3d < 0 and close > lastp1d') [-10:]
top_all.query('per1d > per2d > per3d and per2d < 0 and per3d < 0 and close > lastp1d and boll > 1')
top_all.query('per1d > per2d > per3d and per2d < 0 and per3d < 0 and close > lastp1d and boll > 1 and red >1')
top_all.query('per1d > per2d > per3d and per2d < 0 and per3d < 0 and close > lastp1d and boll > 2 and red >2')
top_all.query('lasth1d > upper and lasth2d < upper2')
top_all.query('lasth1d > upper and lasth2d < upper2 and lasth3d < upper3')
top_all.query('lasth1d > upper and lasth2d < upper2 and lasth3d < upper3 and boll > 3')
top_all.query('lasth1d > upper and category.str.contains("PEEK材料")')
top_all.query('per1d > per2d > per3d and per2d < 0 and per3d < 0 and close > ma5d')
top_all.query('per1d > per2d and lastv1d > lastv2d')
top_all.query('(per1d > 9.8 or per2d > 9.8 or per3d > 9.8)')
top_all.query('(per1d > 9.8 or per2d > 9.8 or per3d > 9.8 and close > upper)')
top_all.query('(per1d > 9.8 or per2d > 9.8 or per3d > 9.8) and close > upper')
top_all.query('(per1d > 9.8 or per2d > 9.8 or per3d > 9.8 and close > upper and boll > 1)')
top_all.query('lasth1d > upper and lasth2d > upper')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d > upper')
top_all.query('per1d > 0 and per2d <0 and per3d <0')
top_all.query('per1d > per2d > per3d and high > upper')
top_all.query('per1d > per2d > per3d and high > upper and lastp2d < upper2')
top_all.query('per1d > per2d > per3d and high > upper and (lastp1d < upper or lastp2d < upper2 or lastp3d < upper3)')
top_all.query('per1d > per2d > per3d and high > upper and (lastp1d < upper or lastp2d < upper2 or lastp3d < upper3) and lasth1d > lasth2d ')
top_all.query('per1d > per2d >per3d')
top_all.query('per1d > 5')
top_all.query('percent > 5')
top_all.query('lastdu4 < 10')
top_all.query('lastdu4 < 10 and percent > lastdu4')
top_all.query('per1d > per2d > per3d and lasth1d > upper')
top_all.query('per1d > per2d > per3d and lasth1d > upper and lasth2d > upper')
top_all.query('per1d > per2d > per3d and lasth2d > upper and lasth1d < upper')
top_all.query('per1d > per2d > per3d and lasth1d > upper and lasth2d < upper')
top_all.query('per1d > per2d > per3d and lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastdu4 < 20')
top_all.query('per1d > per2d > per3d and lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastdu4 < 10')
top_all.query('per1d > 0 and per2d >0 and per3d >0 and lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastdu4 < 10')
top_all.query('per1d > 0 and per2d >0 and per3d >0 and lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastdu4 < 10 and high > max5')
top_all.query('lasth1d < upper1 and high > upper')
top_all.query('lasth1d > lasth2d > lasth3d > upper3')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3')[-50:]
top_all.query('(lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3)')[-50:]
top_all.query('(lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3) and close > lastp1d')
top_all.query('(lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3) and close > lastp1d')[-50:]
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d  > lastp3d')
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d  > lastp3d and close > hmax')
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d  > lastp3d and close > hmax and lastp2d < hmax')
top_temp.query('lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d  > lastp3d and close > hmax and lastp2d < hmax')
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d  > lastp3d and close > hmax and lastp2d < upper2')
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d  > lastp3d and close > hmax and lastp2d < upper2 and close > upper')
top_temp.query('close < lastp1d*1.05 and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d  > lastp3d and close > hmax and lastp2d < upper2 and close > upper')
top_all.query('lasth1d > lasth2d > lasth3d or lastp1d > lastp2d > lastp3d')
top_all.query('lasth1d > lasth2d > lasth3d or lastp1d > lastp2d > lastp3d > upper3')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3 and macddif > 1')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3 and macddif > 1 and macd > 0')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3 and 5 > macddif > 1 and macd > 0')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3 and 5 > macddif > 0')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3 and 5 > macddif > 0 and df2 *1.05 > close > df2')
top_all.query('lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3 and 5 > macddif > 0 and df2*1.05 > close > df2')
top_all.query('(lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3) and 5 > macddif > 0 and df2*1.05 > close > df2')
top_all.query('(lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3) and (close > lastp1d or close > upper)')
top_all.query('(lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3) and (close > lastp1d or close > upper and low < ma5d)')
top_all.query('per1d > 5 and (lasth1d > lasth2d > lasth3d > upper3 or lastp1d > lastp2d > lastp3d > upper3) and (close > lastp1d or close > upper and low < ma5d)')
top_all.query('high > upper and lasth1d < upper')
top_all.query('high > upper and lasth1d < upper1')
top_all.query('high > upper and lastp1d >  upper1')
top_all.query('high > upper and lasth1d > lasth2d > lasth3d')
top_all.query('high > upper and lasth1d > lasth2d > lasth3d > upper3')
top_all.query('high > upper and lasth1d > lasth2d > lasth3d > upper3 and high > hmax')
top_all.query('high > upper and lasth1d > lasth2d > lasth3d > upper3 and high > hmax and lasth1d < high4')
top_all.query('high > upper and lasth1d > lasth2d > lasth3d > upper3 and high > hmax and lasth2d < high4')
top_all.query('(lasth1d > lasth2d > lasth3d > upper3) and lasth1d < high4')
top_all.query('(lasth1d > lasth2d > lasth3d > upper3) and lasth2d < high4')
top_all.query('(lasth1d > lasth2d > lasth3d ) and lasth2d < high4')
top_all.query('(lasth1d > lasth2d > lasth3d ) and lasth1d < high4')
top_all.query('(lasth1d > lasth2d > lasth3d ) and high > hmax')
top_all.query('(lasth1d > lasth2d > lasth3d ) and high > hmax and lasth1d < hmax')
top_all.query('lasth1d >upper3 and lasth2d > upper3')
top_all.query('lasth1d >upper3 and lasth2d > upper3 and lasth3d > upper3')
top_all.query('lasth1d >upper3 and lasth2d > upper3 and lasth3d > upper3 and close > hmax ')
top_all.query('lasth1d >upper3 and lasth2d > upper3 and lasth3d > upper3 and hmax*1.05 > close > hmax ')
top_all.query('lasth1d >upper3 and lasth2d > upper3 and lasth3d > upper3 and hmax*1.05 > close > hmax')
top_all.query('lasth2d < upper2 and lasth1d <upper1 and high > upper')
top_all.query('lasth2d < upper2 and lasth1d <upper1 and high > upper and percent > 5')
top_all.query('lasth2d < upper2 and lasth1d > upper1 and high > upper and percent > -1')
top_all.query('lasth1d < upper1 and high > upper and per1d >0')
top_all.query('high > upper and lasth1d > lasth2d > lasth3d and lastl1d > lastl2d')
top_all.query('high > upper and lasth1d > lasth2d > lasth3d and lastl1d > lastl2d and lasto1d > lasto2d > lasto3d')
top_all.query('high > hmax and lasth1d < hmax and lasth2d < hmax')
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d and  lasth2d > lasth3d  and lastl2d > lastl3d  and low >ma51d and (topR > 0 or (perc1d > 1 and perc2d > 0)) and percent > 0')
top_all.query('percent > 6 and category.str.contains("证券")')
top_all.query('high > hmax and lasth1d < hmax and lasth2d < hmax')[-50:]
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and low >=open')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d ')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and nlow >=low')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and low >=nlow')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and (low >=open or high>upper)')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and (low >=open or high>upper and lasth1d < upper)')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and (low >=open or (high>upper and lasth1d < upper))')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and (low >=open or close > upper and lasth1d > upper)')
top_all.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and (low >=open or close > upper and lasth1d > upper)')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper and lastp1d < lasto1d < lastp1d*1.02 ')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper and lastp1d*0.98 < lasto1d < lastp1d*1.02 ')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper and lastp1d*0.99 < lasto1d < lastp1d*1.02 ')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper and lastp1d*0.99 < lasto1d < lastp1d*1.01 ')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper and lastp1d*0.99 < lasto1d < lastp1d*1.02 and volume > 1')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper and lastp1d*0.99 < lasto1d < lastp1d*1.01 and low > lastl1d')
top_all.query('lasth1d > upper and lasth2d > upper and lasth3d < upper and lastp1d*0.99 < lasto1d < lastp1d*1.01 and low > lastl1d and volume >2')
top_all.query('per1d > per2d')
top_all.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and per1d >= per2d and (low >=open or close > upper and lasth1d > upper) and low > lastp2d')
top_all.query('high > hmax and lasth1d < hmax and lasth2d < hmax and lasth1d > lasth2d')
top_all.query('high > hmax and lasth1d < hmax and lasth2d < hmax and lasth1d > lasth2d > lasth3d')
top_all.query('high > high4 and lasth1d < high4 and lasth2d < hmax and lasth1d > lasth2d > lasth3d')
top_all.query('high > high4 and lasth2d < hmax and lasth1d > lasth2d > lasth3d')
top_all.query('high > high4 and lasth1d > lasth2d > lasth3d')
top_all.query('high > high4 and lasth1d > lasth2d > lasth3d and bandwidth < 12')
top_all.query('high > high4 and lasth1d > lasth2d > lasth3d and bandwidth < 15')
top_all.query('lasth1d > lasth3d and high > hmax')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 20')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 20 and lastv1d > lastv2d')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 20 and lastv1d > lastv2d > lastv3d')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 15')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 15 and low > lastp1d')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 15 and low > lastp1d*0.99')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 15 and low > lastp1d*0.99 and high > upper')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 15 and low > lastp1d*0.99 and high > upper and boll >3')
top_all.query('lasth1d > lasth3d and high > hmax and bandwidth < 15 and high > upper and boll >3 and lasth1d > upper1 and lasth2d > upper')
top_all.query('high > hmax and lasth1d < hmax and lasth2d < hmax and high > high4')
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d and  lasth2d > lasth3d  and lastl2d > lastl3d  and low >ma51d and (topR > 0 or (per1d > 1 and per2d > 0)) and percent > 0 and high > high4')
top_temp.query('close > lastp1d and  lastp1d > lastp2d and  lasth1d > lasth2d  and lastl1d > lastl2d and lastp1d > lastp2d and  lasth2d > lasth3d  and lastl2d > lastl3d  and low >ma51d and (topR > 0 or (per1d > 1 and per2d > 0)) and percent > 0 and high > hmax')
top_all.query('low > lastl1d and percent >4')
top_all.query('low > lastl1d and percent >4 and volume > 1')
top_all.query('low > lastl1d and percent >4 and volume > 2')
top_all.query('low > lastl1d and 6 > percent >4 and volume > 2 and high > upper')
top_all.query('low > lastl1d and 6 > percent >4 and volume > 2 and high > upper and lasth1d < upper')
top_all.query('lasth1d > lasth2d and lasto1d > lastp2d')
top_all.query('lasth1d > lasth2d and lasto1d > lastp2d and high > upper')
top_all.query('lasth1d > lasth2d > lasth3d and lasto1d > lastp2d and  lasto2d > lastp3d')
top_all.query('lasth1d > lasth2d > lasth3d  and lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3')
top_all.query('lasth2d > lasth3d and  lasth2d > upper2 and lasth3d > upper3')
top_all.query('lasth1d > lasth2d > lasth3d  and lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastv1d > lastv2d > lastv3d')
top_all.query('lasth1d > high4')
top_all.query('lasth4d > upper4')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01')[-50:]
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lasth1d > upper')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lasth1d > upper')[-50:]
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lasth1d > upper1')[-50:]
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lasth1d > upper1 and lasth2d > upper2')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lasth1d > upper1 and lasth2d > upper2 and lastv1d > lastv2d')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lasth1d > upper1 and lasth2d > upper2 and lastv1d > lastv2d and bandwidth > 10')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lasth1d > upper1 and lasth2d > upper2 and lastv1d > lastv2d and 5 > boll > 0 ')
top_all.query('low < ma5d and low < ma10d and low<ma20d')
top_all.query('low < ma5d and low < ma10d and low<ma20d and high > high4')
top_all.query('low < ma5d and low < ma10d and low<ma20d and (high >= high4 or high > upper)')
top_all.query('low < ma5d and low < ma10d and (high >= high4 or high > upper)')
top_all.query('low < ma5d and low < ma10d and low < ma20d and (high >= high4 or high > upper)')
top_all.query('low < ma5d and low < ma10d and (high > upper)')
top_all.query('lasth4d > upper4 and lasth5d > upper5')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d and lasth4d > lasth5d')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d and lasth4d > lasth5d and per4d > 2')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d and lasth4d > lasth5d and per4d > 3')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d and lasth4d > lasth5d and per4d > 3 and lastp4d > upper4')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d and lasth4d > lasth5d and per4d > 3 and lastp4d > upper')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d and lasth4d > lasth5d and lasth1d > lasth2d > lasth3d ')
top_all.query('lasth4d > upper4 and lasth5d > upper5 and lastv4d > lastv5d and lasth4d > lasth5d and lasth1d > lasth2d  ')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d ')
top_all.query('lasth1d > lasth2d > lasth3d > lasth4d')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d > lasth5d')
top_all.query('lasth1d > lasth2d > lasth3d > lasth4d > lasth5d')
top_all.query('lasth1d > lasth2d > lasth3d > lasth4d > lasth5d and close > high*0.99')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and boll > 2')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and close > hmax')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and close > hmax and close > high*0.99')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and close > hmax and close > high*0.99 and high < upper')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and close > hmax and close > high*0.99 and high >upper')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and close > hmax and close > high*0.99 and high >upper and category.str.contains("军民融合")')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and close > hmax and close > high*0.99 and high >upper and category.str.contains("人形机器人")')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d and close > hmax and close > high*0.99 and high >upper and lasth2d < upper2')
top_all.query('lasth4d > lasth5d and lasth1d > lasth2d > lasth3d > lasth4d  and close > high*0.99')
top_all.query('lasth1d > lasth2d > lasth3d > lasth4d and close > hmax and close > high*0.99')
top_all.query('close > hmax and close > high*0.99')
top_all.query('close > hmax and close > high*0.99 and high > high4')
top_all.query('close > hmax and close > high*0.99 and high > high4 and high < upper')
top_all.query('close > hmax and close > high*0.99 and high > high4 and high > upper and lastp1d < upper1')
top_all.query('close > hmax and close > high*0.99 and high > high4 and high > upper and lastp1d < upper2')
top_all.query('lasth2d < hmax and high > hmax')
top_all.query('lasth2d < hmax and high > hmax and high > upper')
top_all.query('lasth2d < hmax and high > hmax and high > upper and lasth3d < upper3')
top_all.query('lasth2d < hmax and high > hmax and high > upper and lasth3d < upper3 and lastv1d < lastv2d*1.5')
top_all.query('low < ma20d < ma10d < ma5d')
top_all.query('low < ma20d < ma10d < ma5d and high > upper')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lastv1d > lastv2d')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lastp2d*0.99 < lasto2d < lastp2d*1.01')
top_all.query('lastp1d*0.99 < lasto1d < lastp1d*1.01 and lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and high > upper')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and lasto1d >= lastp2d')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and lasto1d >= lastp2d and lasth2d < upper')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and lasto1d >= lastp2d and lasth1d < upper')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and lasto1d >= lastp2d and lasth3d < upper')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and lasto1d >= lastp2d and lasth3d < upper and red > 1')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and lasto1d >= lastp2d and lasth3d < upper and red > 1 and lastv1d > lastv2d')
top_all.query('lastp2d*0.99 < lasto2d < lastp2d*1.01 and lastp3d*0.99 < lasto3d < lastp3d*1.01 and lasto1d >= lastp2d and red > 1 and lastv1d > lastv2d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d >= lastp2d*0.99 and lasto2d > lastp3d*0.99')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d >= lastp2d*0.99 and lasto2d > lastp3d*0.99')[-50:]
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp1d and lastl2d > lastp2d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp2d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp3d')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp2d')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp3d')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp3d and high > hmax')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp3d and high > hmax and high > upper')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp3d and high > hmax and high > upper and lasth2d < upper')
top_all.query('lasth1d > lasth2d and lastl1d > lastl2d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d > lastp2d and lastl2d > lastp3d and high > hmax and high > upper' )
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d >= lastp2d*0.99 and lasto2d > lastp3d*0.99 and lastv1d < lastv2d ')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d >= lastp2d*0.998 and lasto2d > lastp3d*0.998')
top_all.query('lastp2d*0.998 < lasto2d < lastp2d*1.005 and lastp3d*0.998 < lasto3d < lastp3d*1.005 and lasto1d >= lastp2d and lasth3d < upper and red > 1 and lastv1d > lastv2d')
top_all.query('lastp2d*0.998 < lasto2d < lastp2d*1.005 and lastp3d*0.998 < lasto3d < lastp3d*1.005 ')
top_all.query('lastp1d*0.998 < lasto1d < lastp1d*1.005 and lastp2d*0.998 < lasto2d < lastp2d*1.005 and lastp3d*0.998 < lasto3d < lastp3d*1.005 ')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > upper')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > hmax')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > upper and high > high4')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > upper and volume > 2')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > upper and lasth2d > upper')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > upper and lasth2d > upper2')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > upper and lasth2d > upper and boll > 2')
top_all.query('(lastp2d*0.998 < lasto2d < lastp2d*1.005 or lastp3d*0.998 < lasto3d < lastp3d*1.01) and high > upper and lasth2d > upper and boll > 2  and close > open')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d >= lastp2d*0.99 and lastl2d >= lastp3d*0.99')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d >= lastp2d*0.99 and lastl2d >= lastp3d*0.99 and close > lasth1d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d >= lastp2d*0.99 and lastl2d >= lastp3d*0.99 and close > lasth2d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d >= lastp2d*0.99 and lastl2d >= lastp3d*0.99 and close > lasth2d and close > ma5d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d >= lastp2d*0.99 and lastl2d >= lastp3d*0.99 and close > ma5d')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastl1d >= lastp2d*0.99 and lastl2d >= lastp3d*0.99 and close > upper')
top_all.query('ma51d > ma10d')
top_all.query('ma51d > ma10d and lastp3d < ma51d')
top_all.query('ma51d > ma10d and lastp3d < ma53d')
top_all.query('ma51d > ma10d and lastp3d < ma53d and lastp2d < ma52d')
top_all.query('ma51d > ma10d and lastp3d < ma53d and lastp2d < ma52d and lasth1d > lasth2d')
top_all.query('ma51d > ma10d and lastp3d < ma53d and lastp2d < ma52d and lasth1d > lasth2d and high > hmax')
top_all.query('ma51d > ma10d and lastp3d < ma53d and lastp2d < ma52d and lasth1d > lasth2d and high > high4')
top_all.query('ma51d > ma10d and ma10d > ma53d and lastp3d < ma53d and lastp2d < ma52d and lasth1d > lasth2d and high > high4')
top_all.query('lastp1d*0.998 < lasto1d < lastp1d*1.005')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and close > upper1')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and topR >0')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and lastp1d > lastp2d')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and lastp1d > lastp2d and low >=nlow')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and topR >0 and category.str.contains("固态电池")')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and lastp1d > lastp2d and category.str.contains("汽车电子")')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp2d*0.98 < lasto2d < lastp2d*1.1 and lastp3d*0.98 < lasto3d < lastp3d*1.1 ')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp2d*0.98 < lasto2d < lastp2d*1.1 and lastp3d*0.98 < lasto3d < lastp3d*1.1 and lastp1d > upper1 and lastp1d > lastp2d')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp2d*0.98 < lasto2d < lastp2d*1.1 and lastp3d*0.98 < lasto3d < lastp3d*1.1 and lastp1d > upper1')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp2d*0.98 < lasto2d < lastp2d*1.1 and lastp1d > upper1 and lastp1d > lastp2d')
top_all.query('lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and lastp1d > lastp2d and open > lastp1d')
top_all.query('high > lasth1d')
top_all.query('high > lasth1d and category.str.contains("大飞机")')
top_all.query('lasth1d > lasth2d > lasth3d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastp1d > upper')
top_all.query('lasth1d > lasth2d > lasth3d> lasth4d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastp1d > upper')
top_all.query('lasth1d > lasth2d > lasth3d> lasth4d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and lastp1d > upper and close > lastp1d')
top_all.query('lasth1d > lasth2d > lasth3d> lasth4d and lastl1d > lastl2d > lastl3d and lasto1d > lastp2d and lasto2d > lastp3d and close > lastp1d')
top_all.query('red > 5 and close > hmax')
top_all.query('red > 5 and close > hmax and low < ma51d')
top_all.query('lasth1d > upper and lasth3d > upper')
top_all.query('lasth3d > upper')
top_all.query('lasth3d > upper and lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and lastp1d > lastp2d')
top_all.query('lasth3d > upper and lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and lastp1d > lastp2d and low < ma51d')
top_all.query('lasth3d > upper and lastp1d*0.98 < lasto1d < lastp1d*1.1 and lastp1d > upper1 and lastp1d > lastp2d and low > ma51d')
top_all.query('lasth3d > upper3 and lasth2d > upper2 and lasth1d > upper')
top_all.query('lasth3d > upper3 and lasth2d > upper2 and lasth1d > upper and lastp1d < upper')
top_all.query('lasth3d > upper3 and lasth2d > upper2 and lasth1d > upper and lastp1d < upper and close > upper')
top_all.query('high > upper')
top_all.query('high > upper and lastp1d < upper')
top_all.query('high > upper and lastp1d < upper and high > hmax')
top_all.query('per1d > 5 and lastp1d > upper')
top_all.query('per1d > 5 and lastp1d > upper and close > lastp1d')
top_all.query('per1d > 5 and lastp1d > upper and lasth1d > hmax')
top_all.query('per1d > 5 and lastp1d > upper and close > lastp1d and lasth1d > hmax')
top_all.query('lasth1d > upper  and lasth2d > upper and lasth3d > upper')
top_all.query('lasth1d > upper  and lasth2d > upper and lasth3d > upper and low < upper')
top_all.query('lasth1d > upper  and lasth2d > upper and lasth3d > upper and low > upper')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and open > lastp1d ')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and open > lastp1d and low >=nlow')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and open > lastp1d and low >=open')
top_all.query('open >= high4 and (low >= open*0.995 or low >= lasth2d*0.998) and open >= lasth2d*0.998')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and open > lastp1d and low >= open*0.998')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and open > lastp1d*0.998 and low >= open*0.998')
top_all.query('lasth1d > upper1 and lasth2d > upper2*0.998 and open > lastp1d*0.998 and low >= open*0.998')
top_all.query('lasth1d > upper1 and lasth2d > upper2*0.998 and open > lastp1d*0.998 and low >= open*0.998 and a1_v > 0')
top_all.query('low >= nlow and close >=nclose')
top_all.query('lasth1d > upper1 and lasth3d > upper2*0.998 and open > lastp2d*0.998 and low >= open*0.998')
top_all.query('lasth1d > upper1 and lasth2d > upper2*0.998 and open > lastp2d*0.998 and low >= open*0.998')
top_all.query('lasth1d > upper1 and (lasth2d > upper2*0.998 or (high > upper1 and lasth1d > lasth2d)) and open > lastp1d*0.998 and low >= open*0.998')
top_all.query('lasth1d > upper1 and (lasth2d > upper2*0.998 or (high > upper1 and lasth1d > lasth2d)) and open > lastp1d*0.998 and low >= open*0.998 and a1_v > 0')
top_all.query('lasth2d > upper2 and (lasth3d > upper3*0.998 or (high > upper2 and lasth2d > lasth3d)) and open > lastp2d*0.998 and low >= open*0.998')
top_all.query('lasth2d > upper2 and (lasth3d > upper3*0.998 or (high > upper2 and lasth2d > lasth3d)) and open > lastp2d*0.998 and low >= open*0.998 and a1_v > 0')
top_all.query('per1d >0')
top_all.query('per1d >0 and low < ma51d')
top_all.query('per1d >0 and low < ma51d and category.str.contains("光刻机")')
top_all.query('close > 0 and category.str.contains("光刻机")')
top_all.query('close > 0 and category.str.contains("西部大开发")')
top_all.query('close > 0 and category.str.contains("创新药")')
top_all.query('close > 0 and category.str.contains("芯片概念")')
top_all.query('close > 0 and category.str.contains("人工智能")')
top_all.query('ma51d < ma10d*1.01')
top_all.query('ma10d < ma51d < ma10d*1.01')
top_all.query('ma51d > ma10d*1.01')
top_all.query('ma10d < ma51d < ma10d*1.05')
top_all.query('ma10d < ma51d < ma10d*1.05 and low < ma10d')
top_all.query('ma10d < ma51d < ma10d*1.05 and low < ma51d')
top_all.query('ma10d < ma51d < ma10d*1.05 and lasth1d > hmax')
top_all.query('ma10d < ma51d < ma10d*1.05 and lasth1d > hmax and lasth2d < hmax')
top_all.query('ma10d < ma51d < ma10d*1.05 and lasth1d > hmax and lasth2d < hmax and lastp1d*0.998 < lasto1d < lastp1d*1.005')
top_all.query('ma10d < ma51d < ma10d*1.05 and lasth1d > hmax and lasth2d < hmax and lastp1d*0.998 < lasto1d < lastp1d*1.1')
top_all.query('ma10d < ma51d < ma10d*1.05 and lasth1d > hmax and lasth2d < hmax and low < upper*1.05')
top_all.query('close> hmax and lasth1d < hmax and lasth2d < hmax')
top_all.query('close >= high4 and (low >= close*0.995 or low >= lasth1d*0.998) and close >= lasth1d*0.998')
top_all.query('(close > df2 and low >= open and close > lastp1d and (per1d > 5 or per2d >5) and 3 < bandwidth < 10 ) or  (open > high4 and (low > open*0.999 or low > lasth1d and low > upper) and open > lasth1d) ')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and (low >=open or close > upper and lasth1d > upper)')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and (low >=open or close > upper and close > lastp1d)')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and (low >=open or close > upper and lastp1d > lastp2d)')
top_all.query('high > hmax and lasth1d > hmax and lasth2d < hmax')
top_temp.query('high > high4')
top_temp.query('high > high4 and lasth1d > high4')
top_temp.query('lasth1d > high4')
top_all.query('lasth1d > hmax')
top_all.query('lasth1d > hmax and close > lastp1d')
top_all.query('lasth1d > high4 and close > lastp1d')
top_all.query('lasth1d > high4 and close > lastp1d and lastp2d < high4')
top_all.query('lasth1d > high4 and close > lastp1d and lastp2d < high4 and lasth1d > upper and lasth2d > upper')
top_all.query('lasth1d > high4 and close > lastp1d and lastp2d < high4 and lasth1d > upper and lasth2d > upper and upper > lastl1d > lastl2d > lastl3d ')
top_all.query('lasth1d > high4 and close > lastp1d and lastp2d < high4 and lasth1d > upper and lasth2d > upper and upper > lastl1d > lastl2d > lastl3d and lastp1d > lastp2d')
top_all.query('lasth1d > high4 > hmax and close > lastp1d and lastp2d < high4 and lasth1d > upper and lasth2d > upper and upper > lastl1d > lastl2d > lastl3d and lastp1d > lastp2d')
top_all.query('lasth1d > high4 and lasth1d > upper and upper > lastl1d > lastl2d > lastl3d and lastp1d > lastp2d')
top_all.query('high > high4 and lasth1d > lasth2d and lasth2d > lasth3d and low <= ma5d*1.02 and percent > 0')
top_all.query('high > high4 and lasth1d > lasth2d < upper2 and lasth2d > lasth3d and low <= ma5d*1.02 and percent > 0')
top_all.query('high > high4 and lasth1d > lasth2d > upper2 and lasth2d > lasth3d and low <= ma5d*1.02 and percent > 0')
top_all.query('high > high4 and lasth1d > lasth2d > upper2 and  per2d > per3d and lasth2d > lasth3d and low <= ma5d*1.02 and percent > 0')
top_all.query('high > high4 and lasth1d > lasth2d > upper2 and  per2d > per3d and lasth2d > lasth3d and percent > 0')
top_all.query('high > high4 and lasth1d > lasth2d > upper2 and  per2d > per3d')
top_all.query('high > high4 and lasth1d > lasth2d > upper2 and  (per2d > per3d or per1d > per2d)')
top_all.query('high > high4 and lasth1d > lasth2d > upper2 and  (per2d > per3d or per1d > per2d) and close > open')
top_all.query('boll > 2 and low < ma10d*1.02')
top_all.query('boll > 2 and low < ma10d*1.02 and lasth1d > upper and lasth2d > upper')
top_all.query('boll > 2 and low < ma10d*1.1 and lasth1d > upper and lasth2d > upper')
top_all.query('boll > 2 and low < ma10d*1.1 and lasth1d > upper and lasth2d > upper and high > high4')
top_all.query('boll > 2 and low < ma10d*1.1 and lasth1d > upper and lasth2d > upper and high > high4 and high > hmax')
top_all.query('boll > 2 and low < ma10d*1.1 and lasth1d > upper and lasth2d > upper and lasth1d > lasth2d and high > high4 and high > hmax')
top_all.query('boll > 2 and low < ma10d*1.1 and lasth1d > upper and lasth2d > upper and high > high4 and high > hmax and category.str.contains("人形机器人")')
top_all.query('per1d > 0 and per2d >0 and per3d > 0 and per4d >0')
top_all.query('per1d > 0 and per2d >0 and per3d > 0 and per4d >0 and per5d >0')
top_all.query('per1d > 0 and per2d >0 and per3d > 0 and per4d >0 and per5d >0 and percent > 0')
top_all.query('per1d > 0 and per2d >0 and per3d > 0 and per4d >0  and percent > 0')
top_all.query('per1d > 0 and per2d >0 and per3d > 0 and per4d >0 and per5d >0 and percent > 0 and per1d > per2d')
top_all.query('per1d > 0 and per2d >0 and per3d > 0 and per4d >0 and per5d >0 and percent > 0 and per1d > per2d >3')
top_all.query('per1d > 3 and per2d >0 and per3d > 0 and per4d >0 and per5d >0 and percent > 0')
top_all.query('per1d > 3 and per2d >0 and per3d > 0 and per4d >0 and percent > 0')
top_all.query('per1d > 3 and per2d >0 and per3d > 0 and percent > 0')
top_all.query('per1d > 6')
top_all.query('per1d > 6 and close > lastp1d')
top_all.query('(per1d > 6 or per2d > 6)and close > lastp1d')
top_all.query('(per1d > 8 or per2d > 8)and close > lastp1d')
top_all.query('(per1d > 8 or per2d > 8) and close > lastp1d and close > upper')
top_all.query('(per1d < 6 or per2d < 6) and close > lastp1d and close > upper')
top_all.query('(per1d < 6 and per2d < 6) and close > lastp1d and close > upper')
top_all.query('(per1d < 6 and per2d < 6) and close > lastp1d and close > upper and lastp1d < upper')
top_all.query('lastv1d > lastv2d > lastv3d')
top_all.query('percmax < 3 and percent > percmax')
top_all.query('percmax < 3 and percent > percmax and high > upper')
top_all.query('percmax < 5 and percent > percmax and high > upper')
top_all.query('percmax < 5 and percent > percmax and high > upper and category.str.contains("人形机器人")')
top_all.query('percmax < 5 and percent > percmax and high > upper and category.str.contains("机器人概念")')
top_all.query('percent > 0')
top_all.query('percent > 0 and close >= high *0.98')
top_all.query('percent > 0 and close >= high *0.98 and percmax >5')
top_all.query('percent > 0 and close >= high *0.98 and percmax >5 and category.str.contains("新能源汽车")')
top_all.query('percent > 0 and close >= high *0.98 and percmax < 5 and per1d >0 and per2d >0 and per3d>0')
top_all.query('percent > 0 and close >= high *0.98 and percmax < 5 and per1d >0 and per2d >0 and per3d>0 and red >5')
top_all.query('close >= high *0.98 and percmax < 5 and per1d >0 and per2d >0 and per3d>0 and red >5 ')
top_all.query('close >= high *0.98 and percmax < 5 and per1d >0 and per2d >0 and per3d>0 and red >5 and lastp1d*0.998 < lasto1d < lastp1d*1.005')
top_all.query('close >= high *0.98 and percmax < 5 and per1d >0 and per2d >0 and per3d>0 and red >5 and lastp1d*0.998 < lasto1d < lastp1d*1.1')
top_all.query('close*0.998 < open < close*1.1')
top_all.query('close*0.998 < open < close*1.05')
top_all.query('ma51d > ma10d and lastp1d >=lasth1d *0.998')
top_all.query('ma51d > ma10d*0.99 and lastp1d >=lasth1d *0.998')
top_all.query('ma51d > ma10d*0.99 and lastp1d >=lasth1d *0.998 and ma52d < ma10d')
top_all.query('ma51d > ma10d*0.99 and lastp1d >=lasth1d *0.999 and ma52d < ma10d')
top_all.query('ma51d > ma10d*0.99 and lastp1d >=lasth1d *0.999 and ma52d < ma10d and low < upper')
top_all.query('ma51d > ma10d*0.99 and lastp1d >=lasth1d *0.999 and ma52d < ma10d and low < upper and high > high4')
top_all.query('ma51d > ma10d*0.99 and lastp1d >=lasth1d *0.999 and ma52d < ma10d and low < upper and high > high4 and boll > 0')
top_all.query('ma51d > ma10d*0.99  and lastp1d >=lasth1d *0.999 and low < ma20d and high > high4 and boll > 0')
top_all.query('lastl1d < ma201d or lastl2d < ma202d or lastl3d < ma203d')
top_all.query('(lastl1d < ma201d and per1d > 5) or (lastl2d < ma202d  and per2d > 5) or (lastl3d < ma203d  and per1d > 5)')
top_all.query('(lastl1d < ma201d and per1d > 5) or (lastl2d < ma202d  and per2d > 5) or (lastl3d < ma203d  and per3d > 5)')
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5) or (lastl3d < ma203d*1.03 and per3d > 5) or (low < ma20d*1.03 and percent >3)')
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5) or (lastl3d < ma203d*1.03 and per3d > 5) or (low < ma20d*1.03 and percent >5)')
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5) or (lastl3d < ma203d*1.03 and per3d > 5) or (low < ma20d*1.03 and percent >5)')[-50:]
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5 and lastp1d > lastp2d) or (lastl3d < ma203d*1.03 and per3d > 5) or (low < ma20d*1.03 and percent >5)')[-50:]
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5 and lastp1d > lastp2d*0.99) or (lastl3d < ma203d*1.03 and per3d > 5) or (low < ma20d*1.03 and percent >5)')[-50:]
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5 and lastp1d > lastp2d*0.99) or (lastl3d < ma203d*1.03 and per3d > 5 and lastp2d > lastp3d*0.99) or (low < ma20d*1.03 and percent >5)')[-50:]
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5 and lastp1d > lastp2d*0.99) or (lastl3d < ma203d*1.03 and per3d > 5 and lastp2d > lastp3d*0.99) or (low < ma20d*1.03 and percent >5)')
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5 and close > lastp1d*0.99) or (lastl2d < ma202d*1.03  and per2d > 5 and lastp1d > lastp2d*0.99) or (lastl3d < ma203d*1.03 and per3d > 5 and lastp2d > lastp3d*0.99) or (low < ma20d*1.03 and percent >5)')[-50:]
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5 and lastp1d > lastp2d*0.99) or (lastl3d < ma203d*1.03 and per3d > 5 and lastp2d > lastp3d*0.99) or (low < ma20d*1.03 and percent >5) and high > high4')
top_all.query('(lastl1d < ma201d*1.03 and per1d > 5) or (lastl2d < ma202d*1.03  and per2d > 5 and lastp1d > lastp2d*0.99) or (lastl3d < ma203d*1.03 and per3d > 5 and lastp2d > lastp3d*0.99) or (low < ma20d*1.03 and percent >5) and high > high4 and high > upper*0.95')
top_all.query('(per1d > 8 and close > lastp1d*0.99) or (per2d > 8 and lastp1d > lastp2d*0.99) or (per3d > 8 and lastp2d > lastp3d*0.99 and lastp1d > upper1) or (percent >8) and high > high4 and high > upper*0.95')
top_all.query('(per1d > 8 and close > lastp1d*0.99) or (per2d > 8 and lastp1d > lastp2d*0.99) or (per3d > 8 and lastp2d > lastp3d*0.99 and lastp1d > upper1) or (percent >8) and high > high4 and high > upper*0.95')[-50:]
top_all.query('(per1d > 8 and close > lastp1d*0.99) or (per2d > 8 and lastp1d > lastp2d*0.99 and close > lasto1d) or (per3d > 8 and lastp2d > lastp3d*0.99 and lastp1d > lasto2d) or (percent >8) and high > high4 and high > upper*0.95')[-50:]
top_all.query('(per1d > 8 and close > lastp1d*0.99) or (per2d > 8 and lastp1d > lastp2d*0.99) or (per3d > 8 and lastp2d > lastp3d*0.99 and lastp1d > upper1) or (percent >8) and high > high4 and high > upper*0.95 and boll >0')
top_all.query('(per1d > 8 and close > lastp1d*0.99) or (per2d > 8 and lastp1d > lastp2d*0.99) or (per3d > 8 and lastp2d > lastp3d*0.99 and lastp1d > upper1) or (percent >8) and high > high4 and high > upper*0.95 and boll >0 and red >0')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and lastdu4 < 20')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and lastdu4 > 20')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and lasth2d < hmax and lasth3d < hmax')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and lasth2d < hmax and lasth3d < hmax and per1d > 0 and per2d >0 and per3d >0')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and lasth2d < hmax and lasth3d < hmax and per1d > 0 and per2d >0 and per3d >0 and category.str.contains("海工装备")')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and lasth2d < hmax and lasth3d < hmax and per1d > 0 and per2d >0 and per3d >0 and category.str.contains("PCB概念")')
top_temp.query('low > ma10d  and ((lasth1d > high4) or (high > max5)) and high4==max5 and max5 >=hmax*0.9 and lasth2d < hmax and lasth3d < hmax and per1d > 0 and per2d >0 and per3d >0 and lasth1d > upper')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and per1d > 1 and per2d > 1 and per3d > 1')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and per1d > 3 and per2d > 3 and per3d > 3')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and per1d > 3 and per2d > 3 and per3d > 3 and close > lastp1d')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and per1d > 3 and per2d > 3 and per3d > 3')[-50:]
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and per1d > 3 and per2d > 0 and per3d > 0 and close > lastp1d')
top_all.query('lasto1d > lastp2d*0.99 and lastp1d > lastp2d and lasto2d > lastp3d*0.99 and lastp2d > lastp3d and lasto3d > lastp4d*0.99 and lastp3d > lastp4d and per1d > 3 and per2d > 0 and per3d > 0 and close > lastp1d and category.str.contains("人形机器人")')
top_all.query('lasto1d > lasto2d and lastp1d > lastp2d and lasto2d > lasto3d and lastp2d > lastp3d and lasto3d > lasto4d and lastp3d > lastp4d and per1d > 3 and per2d > 0 and per3d > 0 and close > lastp1d')
top_all.query('lasto1d > lasto2d and lastp1d > lastp2d and lasto2d > lasto3d and lastp2d > lastp3d and lasto3d > lasto4d and lastp3d > lastp4d and per1d > 3 and per2d > 0 and per3d > 0 and close > lastp1d and lasth1d > high4')
top_all.query('high > hmax and lasth1d < hmax and high > high4 and high > upper and lasth1d < upper')
top_temp.query('boll>0 and per1d >=0 and per2d >=0 and per3d >= 0 and ma51d > ma201d  and (low >=open or close > upper and close > lastp2d)')
top_all.query('(lasth1d > upper1 or (open > high4 and lasth1d < high4 and lasth2d < high4)) and (lasth2d > upper2*0.998 or (high > upper1 and lasth1d > lasth2d)) and open > lastp1d*0.998 and low >= open*0.998 and a1_v > 0')
top_all.query('(lasth2d > upper2 or (open > high4 and lasth2d < high4 and lasth3d < high4)) and (lasth3d > upper3*0.998 or (high > upper2 and lasth2d > lasth3d)) and open > lastp2d*0.998 and low >= open*0.998 and a1_v > 0')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > max5*0.99 and close > high4 and volume > 1 and per1d > 8 and close > lasth1d  and low >lasth1d')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > max5*0.99 and close > high4 and volume > 1 and per1d > 3 and close > lasth1d  and low >lasth1d')
top_all.query('close > upper1 and close > df2 and close > high4 and close > lasth1d and close > lasth2d and close > lasth3d and close > upper1    and close > max5*0.99 and close > high4 and volume > 2 and ((((close-lastp1d)/lastp1d*100) > maxp) or (per1d > 3 and close > lasth1d  and low >lasth1d))  and a1_v > 0')
top_all.query('lastdu4 > 10 and lasth1d > upper and lasth2d < upper')
top_all.query('red > 5')
top_all.query('lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4')
top_all.query('lastp1d > high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and lastl1d > upper1')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and low > upper1')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and low > upper')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 ')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and low > upper')[-50:]
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4')[-50:]
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and lastp1d > lastp2d')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and lasth1d > upper')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and lasth1d > upper and per1d > maxp')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and lasth1d > upper and per2d > maxp')
top_all.query('lastp1d > high4 and lastp2d < high4 and lasth2d > lasth3d and lasth2d > lasth4d and lasth2d > lasth5d and lasth2d > high4 and lasth1d > upper and maxp > 5')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastp1d > lastp2d > lastp3d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastp1d > lastp2d > lastp3d and lasth2d > lasth3d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastp1d > lastp2d > lastp3d and lasth2d > lasth3d > lasth4d')
top_all.query('close > 0 and category.str.contains("半导体")')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastp1d > lastp2d > lastp3d and lasth2d > lasth3d > lasth4d and category.str.contains("半导体")')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d and lasth3d > lasth4d > lasth5d')
top_all.query('per2d > per3d and lasth1d > high4 and lasth2d < high4')
top_all.query('per2d > per3d and lasth1d > high4 and lasth2d < high4 and category.str.contains("半导体")')
top_all.query('per2d > per3d and lasth1d > high4 and lasth2d < high4 and category.str.contains("军工")')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and per1d < 10 and per2d < 10 and per3d < 10')
top_all_m.query('per1d > per2d > per3d')
top_all_m.query('per1d > per2d > per3d and lasth2d < upper and lasth1d > upper*0.98')
top_all_m.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper*0.98')
top_all_m.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper1*0.98')
top_all_w.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper*0.98')
top_all_w.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper*0.98 and category.str.contains("半导体")')
top_all_w.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper*0.98 and category.str.contains("消费电子概念")')
top_all_w.query('per1d > per2d > per3d and lasth2d > upper2 and lasth1d > upper*0.98')
top_all_w.query('per1d > per2d > per3d and lasth2d > upper2 and lasth1d > upper*0.98 and category.str.contains("半导体")')
top_all.query('per1d > per2d > per3d and lasth2d > upper2 and lasth1d > upper*0.98 and category.str.contains("半导体")')
top_all.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper*0.98')
top_all.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper*0.98 and category.str.contains("半导体")')
top_all.query('per1d > per2d > per3d and lasth2d < upper2 and lasth1d > upper*0.98 and category.str.contains("芯片")')
top_all.query('per1d > 6 and lasth2d < upper and high > upper')
top_all.query('per1d > 6 and lasth2d < upper and high > upper and category.str.contains("先进封装")')
top_all.query('per1d > 6 and lasth2d < high4 and high > high4')
top_all.query('lastp2d < upper2 and lastp3d < upper3 and lastp4d < upper4 and high > upper')
top_all.query('lastp2d < upper2 and lastp3d < upper3 and lastp4d < upper4 and high > upper and high > high4')
top_all.query('lastp2d < upper2 and lastp3d < upper3 and lastp4d < upper4 and high > upper and high > high4')[-50:]
top_all.query('lastp2d < upper2 and lastp3d < upper3 and lastp4d < upper4 and high > upper and high > high4 and category.str.contains("央企国企")')
top_all.query('lastp2d < upper2 and lastp3d < upper3 and lastp4d < upper4 and high > high4 and category.str.contains("央企国企")')
top_all.query('lastp2d < upper2 and lastp3d < upper3 and lastp4d < upper4 and high > high4')
top_all.query('lasto1d > lasto2d')
top_all.query('lasto1d > lasto2d > lasto3d')
top_all.query('lasto1d > lasto2d > lasto3d')[-50:]
top_all.query('lasto1d > lasto2d > lasto3d and close > lastp1d')[-50:]
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d')[-50:]
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d')
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d and lastp1d > ma51d')
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d and ma51d*1.05 > lastp1d > ma51d')
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d and lastp1d > ma51d and red > 3')
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d and lastp1d > ma51d and red > 2')
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d and lastp1d > ma51d and red > 2 and lasth1d > high4')
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d and lastp1d > ma51d and red > 2 and lasth1d > high4 and low > ma51d')
top_all.query('lasto1d > lasto2d > lasto3d and lastp1d > lastp2d >lastp3d and close > lastp1d and lastp1d > ma51d and red > 2 and lasth1d > high4 and ma51d*1.05 > low > ma51d')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d and lasth3d > lasth4d > lasth5d and lastp1d < upper1')
top_all.query('lastp2d > lastp3d > lastp4d')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d and lasth3d > lasth4d')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d and lasth3d > lasth4d and close > lastp1d')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d and lasth3d > lasth4d and close > lastp1d and close > open')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d and lasth3d > lasth4d and close > lastp1d and close > open')[-50:]
top_all.query('close > ma51d and close > lastp2d and  lastp2d < lastp3d and topR > 0')
top_all.query('close > ma51d and close > lastp2d and  lastp2d > lastp3d and topR > 0')
top_temp.query('close > ma51d and close > lastp2d and  lastp2d > lastp3d and topR > 0')
top_temp.query('close > ma51d and close > lastp2d and  lastp2d > lastp3d')
top_all.query('close > ma51d and close > lastp2d and  lastp2d < lastp3d')
top_all.query('lasth4d > lasth3d > lasth2d and lastl4d >  lastl3d > lastl2d and open > lastl2d and low > open*0.999 and close > lastp2d')
top_temp.query('close > ma51d and close > lastp2d and  lastp2d < lastp3d')
top_temp.query('close > ma51d and close > lastp2d and  lastp2d < lastp4d')
top_temp.query('close > ma51d and close > lastp2d and  lastp3d < lastp4d')
top_temp.query('close > ma51d and close > lastp2d ')
top_temp.query('close > ma51d and low < ma51d and close > lastp2d ')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d  and close > lastp2d and close >= open')
top_all.query('lasth2d > upper2 and lasth3d > upper3 and lasth4d > upper4 and lastp2d > lastp3d > lastp4d  and close > lastp2d and close >= open and lastp2d < upper2')
top_all.query('lasto2d > lasto3d > lasto4d and lastp2d > lastp3d >lastp4d and close > lastp2d and lastp2d > ma52d and red > 2 and low > ma52d')
top_all.query('perc5d > perc3d')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastp1d > lastp2d > lastp3d and close > lastp1d and close >= open and lasth2d < hmax')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastp1d > lastp2d > lastp3d and close > lastp1d and close >= open and lasth2d > hmax')
top_all.query('lasth1d > upper1 and lasth2d > upper2 and lasth3d > upper3 and lastp1d > lastp2d > lastp3d and close > lastp1d and close >= open and lasth1d > hmax')
top_all.query('top10 > 0 and red >4')
top_all.query('top10 > 0 and red >2')
top_all.query('top10 > 0 and red >2 and low > ma51d')
top_all.query('top10 > 0 and red >2 and low < ma51d')
top_all.query('top10 > 0 and red >2 and lastl1d > ma51d')
top_all.query('close > high4 and lastp1d < high4')
top_all.query('close > 0 and category.str.contains("固态电池")')
top_all.query('close > 0 and category.str.contains("peek概念")')
top_all.query('close > 0 and category.str.contains("TOPCON电池")')
top_all.query('close > 0 and category.str.contains("钠离子电池")')
top_all.query('((lasto1d > lasto2d and lastp1d > lastp2d and lasth1d > lasth2d) or (close > high4 and lasth1d < high4)) and lastp1d > ma51d and close > lastp1d')
top_all.query('lasto2d > lasto3d  and lastp2d > lastp3d  and close > lastp2d and lastp2d > ma52d and red > 2 and low > ma52d')
top_all.query('lastp1d > ma51d and lastp2d > ma52d > lastp3d >ma53d')
top_all.query('lastp1d > ma51d and lastp2d > ma52d  and  lastp3d >ma53d and lasth1d > lasth2d > lasth3d and category.str.contains("光刻")')
top_temp.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d and  lasth3d > lasth4d  and lastl3d > lastl4d  and low >ma51d and (topR > 0 or (per1d > 1 and per2d > 0)) and percent > 0')
top_temp.query('close > lastp2d and  lastp2d > lastp3d and  lasth2d > lasth3d  and lastl2d > lastl3d and lastp2d > lastp3d and  lasth3d > lasth4d  and lastl3d > lastl4d  and low >ma51d and (topR > 0 or (per1d > 1 and per2d > 0))')
top_all.query("MainU.str.contains('1|2|3|4|5|6')", engine='python')
