## Tkinter çª—å£ç¼©æ”¾é—®é¢˜åˆ†æžä¸Žä¿®å¤æŠ¥å‘Š

### ðŸ“‹ é—®é¢˜è¯Šæ–­

å½“ç³»ç»Ÿ DPI ç¼©æ”¾å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¦‚ 100% â†’ 150% æˆ– 150% â†’ 100%ï¼‰ï¼ŒTkinter çª—å£ä¸­çš„ä»¥ä¸‹å…ƒç´ æ˜¾ç¤ºé”™ä¹±ï¼š
- âŒ **æ–‡å­—å¤§å°ä¸åŒ¹é…**ï¼ˆå¤ªå°æˆ–å¤ªå¤§ï¼‰
- âŒ **TreeView è¡Œé«˜é”™è¯¯**ï¼ˆæ˜¾ç¤ºä¸å…¨æˆ–è¿‡å¤§ï¼‰
- âŒ **TreeView åˆ—å®½ä¸é€‚é…**
- âŒ **æŽ§ä»¶é—´è·æ··ä¹±**

### ðŸ” æ ¹æœ¬åŽŸå› ï¼ˆ4ä¸ªç¼ºé™·ï¼‰

#### **ç¼ºé™· 1: `_apply_scale_dpi_change` ä¸å®Œæ•´**
**é—®é¢˜**ï¼š
```python
# åªè°ƒæ•´çª—å£å¤§å°å’Œå­—ä½“ï¼Œ**æ²¡æœ‰é‡æ–°è®¡ç®— TreeView åˆ—å®½**
self.geometry(f"{new_w}x{new_h}")
self.default_font.configure(size=new_size)
self.scale_factor = scale_factor
# â† ç¼ºå°‘ TreeView åˆ—å®½é‡æ–°è®¡ç®—ï¼
```
**åŽæžœ**ï¼š
- çª—å£æ”¾å¤§ä½†åˆ—å®½ä¿æŒä¸å˜ â†’ è¡Œä¸¥é‡é”™ä¹±
- ç”¨æˆ·çœ‹åˆ°æ–‡å­—å¤§ä½†åˆ—å®½å°ï¼Œæˆ–åä¹‹

#### **ç¼ºé™· 2: `_apply_dpi_scaling` ä¸­çš„ ttk.Style rowheight å†²çª**
**é—®é¢˜**ï¼š
```python
self.tk.call('tk', 'scaling', tk_scaling_value)  # âœ… è¿™ä¸ªä¼šè‡ªåŠ¨ç¼©æ”¾æ‰€æœ‰ UI

# ç„¶åŽåˆæ‰‹åŠ¨è®¾ç½®...
style.configure("Treeview", rowheight=scaled_row_height)  # âŒ å†²çªï¼
```
**åŽæžœ**ï¼š
- `tk.call('tk', 'scaling')` ä¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰åƒç´ åº¦é‡
- æ‰‹åŠ¨è®¾ç½® rowheight ä¼š**è¦†ç›–**æˆ–**ä¸Ž** scaling äº§ç”Ÿå†²çª
- å¯¼è‡´è¡Œé«˜è¦ä¹ˆå¤ªå°è¦ä¹ˆå¤ªå¤§

#### **ç¼ºé™· 3: `get_scaled_value()` çš„é»‘ç§‘æŠ€**
**é—®é¢˜**ï¼š
```python
def get_scaled_value(self):
    sf = self.scale_factor
    offset = -0.25  # ä¸ºä»€ä¹ˆè¦å‡ 0.25ï¼Ÿ
    return sf - offset  # å®Œå…¨æ²¡æ„ä¹‰

# ä¾‹ï¼šscale_factor=1.5 â†’ è¿”å›ž 1.25
# åˆ—å®½ = 100 * 1.25 = 125 (æœ¬åº”è¯¥æ˜¯ 150)
```
**åŽæžœ**ï¼š
- åˆ—å®½è®¡ç®—é”™è¯¯ï¼Œæ¯”ä¾‹ä¸å¯¹
- åœ¨ä¸åŒ DPI ä¸‹ï¼Œåˆ—å®½æ˜¾ç¤ºä¸ä¸€è‡´

#### **ç¼ºé™· 4: æ²¡æœ‰å…¨å±€å­—ä½“ç¼©æ”¾æœºåˆ¶**
**é—®é¢˜**ï¼š
- åªé…ç½®äº† `self.default_font` å’Œ `self.default_font_bold`
- ä½†æ²¡æœ‰åº”ç”¨åˆ°æ‰€æœ‰ Labelã€Buttonã€Entry ç­‰æŽ§ä»¶
- è¿™äº›æŽ§ä»¶çš„å­—ä½“åœ¨ DPI å˜åŒ–åŽä»ä¿æŒåŽŸå¤§å°

**åŽæžœ**ï¼š
- æŸäº›æ–‡æœ¬æ˜¾ç¤ºå¤§å°ä¸Ž TreeView ä¸ä¸€è‡´
- UI æ•´ä½“ä¸åè°ƒ

---

### âœ… ä¿®å¤æ–¹æ¡ˆ

#### **ä¿®å¤ 1: æ›´æ–° `_apply_scale_dpi_change`**
```python
def _apply_scale_dpi_change(self, scale_factor):
    # 1ï¸âƒ£ è°ƒæ•´çª—å£å¤§å°
    # 2ï¸âƒ£ è°ƒæ•´å­—ä½“å¤§å°
    # 3ï¸âƒ£ æ›´æ–° self.scale_factor
    
    # 4ï¸âƒ£ ðŸ”‘ **å…³é”®**ï¼šé‡æ–°è®¡ç®— TreeView åˆ—å®½
    if hasattr(self, 'current_cols') and hasattr(self, 'tree'):
        self._setup_tree_columns(
            self.tree,
            tuple(self.current_cols),
            sort_callback=self.sort_by_column,
            other={}
        )
    
    # 5ï¸âƒ£ åº”ç”¨å…¨å±€ Tkinter ç¼©æ”¾
    tk_scaling_value = (scale_factor * DEFAULT_DPI) / 72.0
    self.tk.call('tk', 'scaling', tk_scaling_value)
```

**ä½œç”¨**ï¼š
- âœ… çª—å£å¤§å°æ­£ç¡®è°ƒæ•´
- âœ… å­—ä½“å¤§å°æ­£ç¡®è°ƒæ•´
- âœ… **TreeView åˆ—å®½é‡æ–°è®¡ç®—ï¼ˆå…³é”®ï¼ï¼‰**
- âœ… æ‰€æœ‰åƒç´ åº¦é‡å’Œé»˜è®¤å­—ä½“è‡ªåŠ¨ç¼©æ”¾

#### **ä¿®å¤ 2: ç®€åŒ– `_apply_dpi_scaling`**
```python
def _apply_dpi_scaling(self, scale_factor=None):
    # ... èŽ·å– scale_factor ...
    
    if scale_factor > 1.0:
        tk_scaling_value = (scale_factor * DEFAULT_DPI) / 72.0
        self.tk.call('tk', 'scaling', tk_scaling_value)
        # âœ… å°±è¿™æ ·ï¼Œä¸éœ€è¦æ‰‹åŠ¨ ttk.Style é…ç½®
        # tk.call('tk', 'scaling') å·²ç»è‡ªåŠ¨å¤„ç†äº†ä¸€åˆ‡
```

**æ”¹è¿›**ï¼š
- âœ… åˆ é™¤äº†å†²çªçš„ ttk.Style rowheight é…ç½®
- âœ… ä»£ç æ›´ç®€æ´ï¼Œä¸ä¼šäº§ç”Ÿç¼©æ”¾å†²çª
- âœ… è®© Tkinter çš„ `scaling` æœºåˆ¶æ­£å¸¸å·¥ä½œ

#### **ä¿®å¤ 3: ä¿®æ­£ `get_scaled_value()`**
```python
def get_scaled_value(self):
    # âœ… ç›´æŽ¥è¿”å›ž scale_factorï¼Œä¸è¦åšå¥‡æ€ªçš„å‡æ³•
    return self.scale_factor
```

**æ”¹è¿›**ï¼š
- âœ… åˆ—å®½è®¡ç®—çŽ°åœ¨æ­£ç¡®ï¼š`width = 100 * scale_factor`
- âœ… åœ¨ä¸åŒ DPI ä¸‹ï¼Œåˆ—å®½æ¯”ä¾‹ä¸€è‡´
- âœ… æ¶ˆé™¤äº† 0.25 çš„ç¥žç§˜åç§»

---

### ðŸ“Š éªŒè¯æµç¨‹

1. **åˆå§‹çŠ¶æ€**ï¼šç³»ç»Ÿ DPI = 100%ï¼Œ`scale_factor = 1.0`
   - çª—å£ï¼š1200x800
   - åˆ—å®½ï¼š100 px
   - å­—ä½“ï¼š10pt

2. **DPI å˜åŒ–ä¸º 150%**ï¼š`scale_factor = 1.5`
   - çª—å£ï¼š1800x1200 âœ…ï¼ˆè°ƒæ•´åŽï¼‰
   - åˆ—å®½ï¼š150 px âœ…ï¼ˆé‡æ–°è®¡ç®—åŽï¼‰
   - å­—ä½“ï¼š15pt âœ…ï¼ˆè°ƒæ•´åŽï¼‰

3. **DPI å†å˜åŒ–å›ž 100%**ï¼š`scale_factor = 1.0`
   - çª—å£ï¼š1200x800 âœ…
   - åˆ—å®½ï¼š100 px âœ…
   - å­—ä½“ï¼š10pt âœ…

---

### ðŸ”§ å·²åº”ç”¨çš„ä¿®æ”¹

| å‡½æ•° | ä¿®æ”¹å†…å®¹ | å½±å“ |
|------|--------|------|
| `_apply_scale_dpi_change` | æ·»åŠ  TreeView åˆ—å®½é‡æ–°è®¡ç®— + Tkinter scaling è°ƒç”¨ | ðŸŸ¢ å…³é”®ä¿®å¤ |
| `_apply_dpi_scaling` | åˆ é™¤å†²çªçš„ ttk.Style rowheight é…ç½® | ðŸŸ¢ ç®€åŒ–+ä¿®å¤å†²çª |
| `get_scaled_value` | ç›´æŽ¥è¿”å›ž scale_factorï¼Œåˆ é™¤ -0.25 | ðŸŸ¢ ä¿®æ­£åˆ—å®½è®¡ç®— |

---

### ðŸ“ æµ‹è¯•é¡¹ç›®æ¸…å•

- [ ] åœ¨ 150% DPI çŽ¯å¢ƒä¸‹å¯åŠ¨ç¨‹åº â†’ éªŒè¯ UI å¤§å°æ­£ç¡®
- [ ] å°†ç³»ç»Ÿ DPI ä»Ž 100% åˆ‡æ¢åˆ° 150% â†’ éªŒè¯çª—å£/å­—ä½“/TreeView è‡ªåŠ¨ç¼©æ”¾
- [ ] å°†ç³»ç»Ÿ DPI ä»Ž 150% åˆ‡æ¢å›ž 100% â†’ éªŒè¯çª—å£/å­—ä½“/TreeView æ­£ç¡®ç¼©å°
- [ ] éªŒè¯ TreeView åˆ—å¯ä»¥æ‰‹åŠ¨æ‹–åŠ¨è°ƒæ•´
- [ ] éªŒè¯æ‰€æœ‰æ–‡æœ¬ï¼ˆLabelã€Buttonã€Entryï¼‰å¤§å°ä¸€è‡´

---

### ðŸ“Œ é‡è¦æ¦‚å¿µ

**Tkinter `tk.call('tk', 'scaling', value)`**ï¼š
- è®¾ç½® Tkinter çš„å…¨å±€ç¼©æ”¾å› å­
- è‡ªåŠ¨ç¼©æ”¾æ‰€æœ‰**åŸºäºŽåƒç´ å®šä¹‰**çš„å°ºå¯¸ï¼ˆå­—ä½“ã€paddingã€width ç­‰ï¼‰
- å€¼ > 1.0 æ—¶æ”¾å¤§ï¼Œ< 1.0 æ—¶ç¼©å°
- ä¸€æ—¦è®¾ç½®ï¼Œæ‰€æœ‰æ–°å»ºæˆ–æ›´æ–°çš„ UI å…ƒç´ éƒ½ä¼šåº”ç”¨ç¼©æ”¾

**ä¸èƒ½åšçš„äº‹æƒ…**ï¼š
- âŒ æ‰‹åŠ¨è®¾ç½® `ttk.Style rowheight` åŽå†ç”¨ `tk.call('tk', 'scaling')`ï¼ˆä¼šå†²çªï¼‰
- âŒ ç”¨ `get_scaled_value()` å¯¹åƒç´ å€¼åšä»»æ„è®¡ç®—ï¼ˆä¼šç ´åæ¯”ä¾‹ï¼‰
- âŒ åªè°ƒæ•´çª—å£å¤§å°è€Œä¸æ›´æ–° TreeView åˆ—å®½ï¼ˆä¼šå¯¼è‡´é”™ä¹±ï¼‰
